graph_templates {
  key: "4x_bh_qb"
  value {
    children {
      name: "system1"
      node_ref { node_descriptor: "p150_qb_node" }
    }
    children {
      name: "system2"
      node_ref { node_descriptor: "p150_qb_node" }
    }
    children {
      name: "system3"
      node_ref { node_descriptor: "p150_qb_node" }
    }
    children {
      name: "system4"
      node_ref { node_descriptor: "p150_qb_node" }
    }
    internal_connections {
      key: "QSFP"
      value {
        # System 1 to System 3 connections on Port 1
        connections {
          port_a { path: ["system1"] tray_id: 1 port_id: 1 }
          port_b { path: ["system3"] tray_id: 1 port_id: 1 }
        }
        connections {
          port_a { path: ["system1"] tray_id: 2 port_id: 1 }
          port_b { path: ["system3"] tray_id: 2 port_id: 1 }
        }
        connections {
          port_a { path: ["system1"] tray_id: 3 port_id: 1 }
          port_b { path: ["system3"] tray_id: 3 port_id: 1 }
        }
        connections {
          port_a { path: ["system1"] tray_id: 4 port_id: 1 }
          port_b { path: ["system3"] tray_id: 4 port_id: 1 }
        }

        # System 1 to System 2 connections on Port 4
        connections {
          port_a { path: ["system1"] tray_id: 1 port_id: 4 }
          port_b { path: ["system2"] tray_id: 1 port_id: 4 }
        }
        connections {
          port_a { path: ["system1"] tray_id: 2 port_id: 4 }
          port_b { path: ["system2"] tray_id: 2 port_id: 4 }
        }
        connections {
          port_a { path: ["system1"] tray_id: 3 port_id: 4 }
          port_b { path: ["system2"] tray_id: 3 port_id: 4 }
        }
        connections {
          port_a { path: ["system1"] tray_id: 4 port_id: 4 }
          port_b { path: ["system2"] tray_id: 4 port_id: 4 }
        }

        # System 3 to System 4 connections on Port 4
        connections {
          port_a { path: ["system3"] tray_id: 1 port_id: 4 }
          port_b { path: ["system4"] tray_id: 1 port_id: 4 }
        }
        connections {
          port_a { path: ["system3"] tray_id: 2 port_id: 4 }
          port_b { path: ["system4"] tray_id: 2 port_id: 4 }
        }
        connections {
          port_a { path: ["system3"] tray_id: 3 port_id: 4 }
          port_b { path: ["system4"] tray_id: 3 port_id: 4 }
        }
        connections {
          port_a { path: ["system3"] tray_id: 4 port_id: 4 }
          port_b { path: ["system4"] tray_id: 4 port_id: 4 }
        }

        # System 2 to System 4 connections on Port 1
        connections {
          port_a { path: ["system2"] tray_id: 1 port_id: 1 }
          port_b { path: ["system4"] tray_id: 1 port_id: 1 }
        }
        connections {
          port_a { path: ["system2"] tray_id: 2 port_id: 1 }
          port_b { path: ["system4"] tray_id: 2 port_id: 1 }
        }
        connections {
          port_a { path: ["system2"] tray_id: 3 port_id: 1 }
          port_b { path: ["system4"] tray_id: 3 port_id: 1 }
        }
        connections {
          port_a { path: ["system2"] tray_id: 4 port_id: 1 }
          port_b { path: ["system4"] tray_id: 4 port_id: 1 }
        }
      }
    }
  }
}

# Root instance
root_instance {
  template_name: "4x_bh_qb"
  child_mappings {
    key: "system1"
    value { host_id: 0 }
  }
  child_mappings {
    key: "system2"
    value { host_id: 1 }
  }
  child_mappings {
    key: "system3"
    value { host_id: 2 }
  }
  child_mappings {
    key: "system4"
    value { host_id: 3 }
  }
}
