// SPDX-FileCopyrightText: Â© 2025 Tenstorrent AI ULC.
// SPDX-License-Identifier: Apache-2.0

#pragma once

#include "ttnn/tensor/tensor.hpp"
#include "ttnn/tensor/types.hpp"

#include <optional>

namespace ttnn::prim {

/*
 * Generates the output shape for the reduction operation.
 * The output shape is generated by iterating over the input shape and adjusting
 * the output shape for keepdim.
 * @param input_tensor The input tensor on which reduction is performed.
 * @param dim The dimension to reduce on (optional).
 * @param keepdim Whether to keep the reduced dimension.
 * @return The output shape.
 */
ttnn::SmallVector<uint32_t> get_output_shape(const Tensor& input_tensor, const std::optional<int>& dim, bool keepdim);

}  // namespace ttnn::prim
