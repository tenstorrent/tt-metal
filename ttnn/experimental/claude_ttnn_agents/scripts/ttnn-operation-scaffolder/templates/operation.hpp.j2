// SPDX-FileCopyrightText: Â© 2025 Tenstorrent AI ULC
//
// SPDX-License-Identifier: Apache-2.0

#pragma once

#include <optional>
#include <tuple>
#include "ttnn/decorators.hpp"
#include "device/{{ operation_name }}_device_operation.hpp"

namespace ttnn {
namespace operations {
namespace {{ operation_name }} {

struct Execute{{ operation_name_pascal }} {
    static ttnn::Tensor invoke(
{% for tensor in input_tensors %}
        const ttnn::Tensor& {{ tensor.cpp_name }},
{% endfor %}
{% for param in parameters %}
        {{ param.cpp_type }} {{ param.name }}{% if param.default %} = {{ param.default }}{% endif %},
{% endfor %}
        const std::optional<MemoryConfig>& memory_config = std::nullopt);
};

}  // namespace {{ operation_name }}
}  // namespace operations

// Register the operation
constexpr auto {{ operation_name }} =
    ttnn::register_operation<"ttnn::{{ operation_name }}", ttnn::operations::{{ operation_name }}::Execute{{ operation_name_pascal }}>();

}  // namespace ttnn
