// SPDX-FileCopyrightText: Â© 2024 Tenstorrent Inc.
//
// SPDX-License-Identifier: Apache-2.0

#include "common/assert.hpp"
#include "common/bfloat16.hpp"
#include "ttnn/cpp/ttnn/tensor/host_buffer/functions.hpp"
#include "ttnn/cpp/ttnn/tensor/types.hpp"
#include "ttnn/tensor/host_buffer/functions.hpp"
#include "ttnn/tensor/host_buffer/types.hpp"
#include "ttnn/tensor/tensor.hpp"
#include "ttnn/tensor/tensor.hpp"
#include "ttnn/operations/creation.hpp"
#include "ttnn/operations/functions.hpp"
#include "ttnn/tensor/types.hpp"
#include "ttnn/cpp/ttnn/operations/conv/conv2d/prepare_conv2d_weights.hpp"

static std::vector<std::vector<bfloat16>> ref_weight_in = {
    {
        16140, 16151, 16183, 16216, 16154, 16219, 16139, 16216, 16088, 16159, 16165, 16068, 16096, 16024, 16228, 15720,
        16246, 16011, 16068, 16116, 16202, 16207, 16135, 16117, 16145, 16073, 16236, 16214, 15761, 16044, 15794, 16165,
        15525, 16060, 16213, 16245, 16199, 15887, 16222, 16222, 16250, 16114, 16204, 16205, 16108, 16133, 16199, 16173,
        15858, 16184, 16163, 16148, 15890, 16137, 16241, 16194, 16133, 15832, 16084, 16114, 16007, 15934, 16198, 16188,
        16105, 15965, 16145, 15882, 15513, 16037, 16158, 15897, 16156, 15971, 16157, 16069, 16241, 16231, 16174, 16102,
        16056, 16156, 16095, 16231, 16178, 15819, 15734, 16248, 16170, 16167, 16171, 15919, 15959, 16055, 15876, 16192,
        16033, 16155, 16058, 16038, 16145, 15645, 16096, 16162, 16253, 16245, 15824, 16167, 15957, 16162, 15909, 16254,
        16167, 16148, 16001, 16084, 16110, 16115, 15994, 16159, 15906, 16045, 15842, 16172, 16168, 16034, 15885, 16199,
        15945, 16243, 16060, 16169, 16210, 15454, 15814, 16159, 16214, 16172, 15812, 16248, 16249, 16224, 16111, 16130,
        16250, 15716, 16154, 16102, 16189, 15523, 15648, 16098, 16016, 16250, 15862, 16056, 16023, 16118, 15859, 16176,
        16034, 16225, 16084, 16235, 15747, 15966, 16177, 16144, 16145, 16221, 16007, 16130, 16133, 16234, 15808, 16235,
        16147, 15786, 16237, 16014, 16035, 15385, 16170, 16215, 15878, 16165, 16183, 16215, 16020, 16007, 15931, 16075,
        16150, 16141, 15524, 15912, 16212, 16061, 15257, 15893, 16173, 16145, 16010, 16180, 16188, 16019, 16246, 16093,
        15998, 16193, 16147, 16074, 16151, 16229, 16146, 16163, 15972, 16228, 16243, 16174, 16100, 16101, 16216, 16250,
        16179, 15853, 16024, 16196, 16208, 16082, 16075, 16172, 16225, 15999, 16148, 16032, 16225, 16247, 16177, 16150,
        16185, 16168, 16128, 16136, 16244, 15980, 16164, 16074, 16089, 16158, 16155, 16115, 15517, 16112, 16026, 16183,
        16169, 16019, 16020, 16068, 16158, 16191, 16091, 16224, 15882, 15826, 16024, 15805, 16145, 16053, 16151, 16141,
        16147, 15625, 16167, 16248, 16166, 16036, 16092, 15970, 16229, 15888, 16060, 15815, 16095, 16251, 16228, 16005,
        16206, 16137, 16180, 16101, 15821, 15819, 16235, 16052, 16182, 16112, 16255, 16215, 15897, 16231, 16222, 15641,
        15910, 16130, 16157, 15914, 15869, 16199, 16217, 16221, 16206, 16082, 16145, 15887, 16080, 15624, 15757, 16251,
        16178, 16063, 16104, 16087, 16184, 15695, 16221, 16059, 16249, 15496, 16219, 15980, 15423, 16195, 16056, 16241,
        16186, 16191, 15919, 16045, 16133, 16122, 15710, 16045, 15948, 15927, 15511, 15919, 16203, 16109, 15973, 16223,
        16048, 16241, 16237, 16155, 16180, 16152, 15618, 16200, 15912, 16128, 16159, 15694, 16147, 16178, 15987, 16254,
        16239, 16008, 16157, 16173, 16137, 16221, 16151, 16192, 16186, 16246, 16031, 16141, 16075, 15961, 15958, 15971,
        15934, 15967, 16241, 16145, 16189, 16103, 16123, 16248, 15976, 16174, 16002, 15790, 15725, 15719, 16094, 16121,
        16031, 16225, 16178, 16249, 16065, 16158, 15927, 16138, 15562, 16218, 15753, 16190, 16173, 16117, 16104, 16173,
        16137, 16155, 16229, 16182, 16253, 16112, 15966, 16105, 16169, 16232, 16006, 15884, 15529, 15978, 16194, 16225,
        16035, 16231, 16068, 16165, 16150, 16038, 16212, 16133, 16161, 14440, 16223, 16031, 16012, 16089, 16204, 16226,
        15934, 16174, 16243, 16105, 16175, 16119, 15964, 16201, 16242, 15978, 16187, 16225, 16002, 16032, 15962, 16245,
        16132, 16113, 15570, 16182, 15956, 15901, 16089, 16186, 16063, 16165, 16109, 15964, 16014, 15934, 16150, 16206,
        16221, 16191, 15856, 16172, 16132, 16013, 15879, 15923, 16183, 16180, 16074, 16109, 16144, 16215, 15931, 15953,
        15892, 15912, 16121, 15871, 16054, 16184, 16240, 15609, 16195, 16191, 16191, 15805, 16231, 15966, 15786, 16191,
        16141, 16187, 16149, 15674, 16246, 15958, 16021, 16018, 15990, 16173, 15821, 15745, 15494, 16142, 16237, 15383,
        16171, 16213, 16200, 16251, 16016, 16180, 16150, 15929, 15746, 16131, 16120, 16148, 16250, 16201, 16224, 16155,
        16045, 15967, 16246, 16105, 15981, 16224, 16243, 16124, 16240, 16183, 16204, 16120, 16161, 16181, 16223, 16127,
        16022, 16216, 16217, 15943, 16158, 16197, 15448, 16249, 16049, 16220, 15895, 16199, 16251, 16252, 16116, 16192,
    },

    {
        16140, 16151, 16183, 16216, 16154, 16219, 16139, 16216, 16088, 16159, 16165, 16068, 16096, 16024, 16228, 15720,
        16246, 16011, 16068, 16116, 16202, 16207, 16135, 16117, 16145, 16073, 16236, 16214, 15761, 16044, 15794, 16165,
        15525, 16060, 16213, 16245, 16199, 15887, 16222, 16222, 16250, 16114, 16204, 16205, 16108, 16133, 16199, 16173,
        15858, 16184, 16163, 16148, 15890, 16137, 16241, 16194, 16133, 15832, 16084, 16114, 16007, 15934, 16198, 16188,
        16105, 15965, 16145, 15882, 15513, 16037, 16158, 15897, 16156, 15971, 16157, 16069, 16241, 16231, 16174, 16102,
        16056, 16156, 16095, 16231, 16178, 15819, 15734, 16248, 16170, 16167, 16171, 15919, 15959, 16055, 15876, 16192,
        16033, 16155, 16058, 16038, 16145, 15645, 16096, 16162, 16253, 16245, 15824, 16167, 15957, 16162, 15909, 16254,
        16167, 16148, 16001, 16084, 16110, 16115, 15994, 16159, 15906, 16045, 15842, 16172, 16168, 16034, 15885, 16199,
        15945, 16243, 16060, 16169, 16210, 15454, 15814, 16159, 16214, 16172, 15812, 16248, 16249, 16224, 16111, 16130,
        16250, 15716, 16154, 16102, 16189, 15523, 15648, 16098, 16016, 16250, 15862, 16056, 16023, 16118, 15859, 16176,
        16034, 16225, 16084, 16235, 15747, 15966, 16177, 16144, 16145, 16221, 16007, 16130, 16133, 16234, 15808, 16235,
        16147, 15786, 16237, 16014, 16035, 15385, 16170, 16215, 15878, 16165, 16183, 16215, 16020, 16007, 15931, 16075,
        16150, 16141, 15524, 15912, 16212, 16061, 15257, 15893, 16173, 16145, 16010, 16180, 16188, 16019, 16246, 16093,
        15998, 16193, 16147, 16074, 16151, 16229, 16146, 16163, 15972, 16228, 16243, 16174, 16100, 16101, 16216, 16250,
        16179, 15853, 16024, 16196, 16208, 16082, 16075, 16172, 16225, 15999, 16148, 16032, 16225, 16247, 16177, 16150,
        16185, 16168, 16128, 16136, 16244, 15980, 16164, 16074, 16089, 16158, 16155, 16115, 15517, 16112, 16026, 16183,
        16169, 16019, 16020, 16068, 16158, 16191, 16091, 16224, 15882, 15826, 16024, 15805, 16145, 16053, 16151, 16141,
        16147, 15625, 16167, 16248, 16166, 16036, 16092, 15970, 16229, 15888, 16060, 15815, 16095, 16251, 16228, 16005,
        16206, 16137, 16180, 16101, 15821, 15819, 16235, 16052, 16182, 16112, 16255, 16215, 15897, 16231, 16222, 15641,
        15910, 16130, 16157, 15914, 15869, 16199, 16217, 16221, 16206, 16082, 16145, 15887, 16080, 15624, 15757, 16251,
        16178, 16063, 16104, 16087, 16184, 15695, 16221, 16059, 16249, 15496, 16219, 15980, 15423, 16195, 16056, 16241,
        16186, 16191, 15919, 16045, 16133, 16122, 15710, 16045, 15948, 15927, 15511, 15919, 16203, 16109, 15973, 16223,
        16048, 16241, 16237, 16155, 16180, 16152, 15618, 16200, 15912, 16128, 16159, 15694, 16147, 16178, 15987, 16254,
        16239, 16008, 16157, 16173, 16137, 16221, 16151, 16192, 16186, 16246, 16031, 16141, 16075, 15961, 15958, 15971,
        15934, 15967, 16241, 16145, 16189, 16103, 16123, 16248, 15976, 16174, 16002, 15790, 15725, 15719, 16094, 16121,
        16031, 16225, 16178, 16249, 16065, 16158, 15927, 16138, 15562, 16218, 15753, 16190, 16173, 16117, 16104, 16173,
        16137, 16155, 16229, 16182, 16253, 16112, 15966, 16105, 16169, 16232, 16006, 15884, 15529, 15978, 16194, 16225,
        16035, 16231, 16068, 16165, 16150, 16038, 16212, 16133, 16161, 14440, 16223, 16031, 16012, 16089, 16204, 16226,
        15934, 16174, 16243, 16105, 16175, 16119, 15964, 16201, 16242, 15978, 16187, 16225, 16002, 16032, 15962, 16245,
        16132, 16113, 15570, 16182, 15956, 15901, 16089, 16186, 16063, 16165, 16109, 15964, 16014, 15934, 16150, 16206,
        16221, 16191, 15856, 16172, 16132, 16013, 15879, 15923, 16183, 16180, 16074, 16109, 16144, 16215, 15931, 15953,
        15892, 15912, 16121, 15871, 16054, 16184, 16240, 15609, 16195, 16191, 16191, 15805, 16231, 15966, 15786, 16191,
        16141, 16187, 16149, 15674, 16246, 15958, 16021, 16018, 15990, 16173, 15821, 15745, 15494, 16142, 16237, 15383,
        16171, 16213, 16200, 16251, 16016, 16180, 16150, 15929, 15746, 16131, 16120, 16148, 16250, 16201, 16224, 16155,
        16045, 15967, 16246, 16105, 15981, 16224, 16243, 16124, 16240, 16183, 16204, 16120, 16161, 16181, 16223, 16127,
        16022, 16216, 16217, 15943, 16158, 16197, 15448, 16249, 16049, 16220, 15895, 16199, 16251, 16252, 16116, 16192,
        16126, 15236, 16163, 16009, 16060, 16082, 15884, 16091, 16210, 16024, 15938, 16077, 16130, 15863, 15973, 16251,
        15816, 16079, 16220, 16145, 16249, 16047, 16245, 16201, 16232, 16082, 16198, 16055, 16042, 16076, 15782, 16026,
        16080, 16198, 15981, 16237, 15879, 16038, 15706, 16243, 16185, 15460, 15419, 16136, 16197, 16027, 15894, 16226,
        15778, 16000, 15799, 16173, 16172, 16207, 15995, 16093, 16087, 16192, 16142, 16212, 16220, 16066, 16186, 15813,
        16010, 16003, 15878, 16151, 15714, 16115, 16026, 16121, 16006, 16106, 16105, 16134, 16174, 16098, 16178, 16218,
        16017, 16093, 16066, 16211, 15929, 16130, 16201, 15792, 15720, 16168, 16178, 15955, 16199, 16216, 16199, 16174,
        16004, 15926, 16063, 15759, 16150, 15390, 16011, 16228, 16061, 15880, 15945, 16199, 16107, 16236, 15670, 16183,
        16204, 16123, 15773, 16112, 16132, 16225, 16029, 16122, 16147, 16084, 16245, 15922, 16165, 16115, 15632, 16200,
        16092, 16142, 16130, 15907, 16137, 15891, 16174, 16166, 16014, 16138, 15875, 16038, 16073, 15894, 16244, 15907,
        15935, 15876, 16231, 16148, 16139, 15804, 16105, 16233, 16225, 15785, 16106, 16204, 16185, 16224, 16076, 15807,
        16231, 16090, 16176, 16114, 16179, 16148, 16039, 16183, 16193, 15581, 16162, 16187, 15989, 16196, 15908, 15392,
        16203, 16029, 16245, 15982, 16106, 16128, 16151, 16244, 16219, 16142, 16106, 15815, 16243, 16159, 16147, 16220,
        16210, 15905, 16232, 16254, 16208, 15790, 15907, 15809, 16160, 16162, 16075, 16243, 15744, 16239, 16089, 16101,
        16004, 16186, 16217, 16190, 15624, 16029, 16245, 15861, 16053, 16099, 16054, 16072, 15493, 16136, 15933, 16216,
        16077, 16137, 16237, 16174, 15820, 16155, 16241, 15817, 16222, 15804, 16104, 15717, 16039, 15793, 15982, 15986,
        16157, 16214, 15623, 16133, 15487, 16131, 16091, 16166, 15755, 16139, 16000, 15620, 15970, 16148, 16001, 16197,
        15878, 16064, 15429, 16123, 15852, 16251, 16158, 15994, 16249, 16063, 16253, 15675, 16081, 16030, 15910, 16212,
        16163, 16206, 16123, 16163, 16253, 16060, 15749, 16032, 16200, 16205, 16019, 15760, 15991, 16174, 16169, 16066,
        15995, 16162, 16170, 16237, 16132, 16218, 16089, 16126, 16142, 16091, 16018, 16210, 16180, 16188, 16084, 16100,
        16056, 16248, 16212, 16057, 16236, 16075, 15676, 16189, 15982, 16101, 16050, 16239, 16208, 16003, 16252, 16067,
        16248, 16178, 16231, 16229,
    },

    {
        16140, 16151, 16183, 16216, 16154, 16219, 16139, 16216, 16088, 16159, 16165, 16068, 16096, 16024, 16228, 15720,
        16246, 16011, 16068, 16116, 16202, 16207, 16135, 16117, 16145, 16073, 16236, 16214, 15761, 16044, 15794, 16165,
        15525, 16060, 16213, 16245, 16199, 15887, 16222, 16222, 16250, 16114, 16204, 16205, 16108, 16133, 16199, 16173,
        15858, 16184, 16163, 16148, 15890, 16137, 16241, 16194, 16133, 15832, 16084, 16114, 16007, 15934, 16198, 16188,
        16105, 15965, 16145, 15882, 15513, 16037, 16158, 15897, 16156, 15971, 16157, 16069, 16241, 16231, 16174, 16102,
        16056, 16156, 16095, 16231, 16178, 15819, 15734, 16248, 16170, 16167, 16171, 15919, 15959, 16055, 15876, 16192,
        16033, 16155, 16058, 16038, 16145, 15645, 16096, 16162, 16253, 16245, 15824, 16167, 15957, 16162, 15909, 16254,
        16167, 16148, 16001, 16084, 16110, 16115, 15994, 16159, 15906, 16045, 15842, 16172, 16168, 16034, 15885, 16199,
        15945, 16243, 16060, 16169, 16210, 15454, 15814, 16159, 16214, 16172, 15812, 16248, 16249, 16224, 16111, 16130,
        16250, 15716, 16154, 16102, 16189, 15523, 15648, 16098, 16016, 16250, 15862, 16056, 16023, 16118, 15859, 16176,
        16034, 16225, 16084, 16235, 15747, 15966, 16177, 16144, 16145, 16221, 16007, 16130, 16133, 16234, 15808, 16235,
        16147, 15786, 16237, 16014, 16035, 15385, 16170, 16215, 15878, 16165, 16183, 16215, 16020, 16007, 15931, 16075,
        16150, 16141, 15524, 15912, 16212, 16061, 15257, 15893, 16173, 16145, 16010, 16180, 16188, 16019, 16246, 16093,
        15998, 16193, 16147, 16074, 16151, 16229, 16146, 16163, 15972, 16228, 16243, 16174, 16100, 16101, 16216, 16250,
        16179, 15853, 16024, 16196, 16208, 16082, 16075, 16172, 16225, 15999, 16148, 16032, 16225, 16247, 16177, 16150,
        16185, 16168, 16128, 16136, 16244, 15980, 16164, 16074, 16089, 16158, 16155, 16115, 15517, 16112, 16026, 16183,
        16169, 16019, 16020, 16068, 16158, 16191, 16091, 16224, 15882, 15826, 16024, 15805, 16145, 16053, 16151, 16141,
        16147, 15625, 16167, 16248, 16166, 16036, 16092, 15970, 16229, 15888, 16060, 15815, 16095, 16251, 16228, 16005,
        16206, 16137, 16180, 16101, 15821, 15819, 16235, 16052, 16182, 16112, 16255, 16215, 15897, 16231, 16222, 15641,
        15910, 16130, 16157, 15914, 15869, 16199, 16217, 16221, 16206, 16082, 16145, 15887, 16080, 15624, 15757, 16251,
        16178, 16063, 16104, 16087, 16184, 15695, 16221, 16059, 16249, 15496, 16219, 15980, 15423, 16195, 16056, 16241,
        16186, 16191, 15919, 16045, 16133, 16122, 15710, 16045, 15948, 15927, 15511, 15919, 16203, 16109, 15973, 16223,
        16048, 16241, 16237, 16155, 16180, 16152, 15618, 16200, 15912, 16128, 16159, 15694, 16147, 16178, 15987, 16254,
        16239, 16008, 16157, 16173, 16137, 16221, 16151, 16192, 16186, 16246, 16031, 16141, 16075, 15961, 15958, 15971,
        15934, 15967, 16241, 16145, 16189, 16103, 16123, 16248, 15976, 16174, 16002, 15790, 15725, 15719, 16094, 16121,
        16031, 16225, 16178, 16249, 16065, 16158, 15927, 16138, 15562, 16218, 15753, 16190, 16173, 16117, 16104, 16173,
        16137, 16155, 16229, 16182, 16253, 16112, 15966, 16105, 16169, 16232, 16006, 15884, 15529, 15978, 16194, 16225,
        16035, 16231, 16068, 16165, 16150, 16038, 16212, 16133, 16161, 14440, 16223, 16031, 16012, 16089, 16204, 16226,
        15934, 16174, 16243, 16105, 16175, 16119, 15964, 16201, 16242, 15978, 16187, 16225, 16002, 16032, 15962, 16245,
        16132, 16113, 15570, 16182, 15956, 15901, 16089, 16186, 16063, 16165, 16109, 15964, 16014, 15934, 16150, 16206,
        16221, 16191, 15856, 16172, 16132, 16013, 15879, 15923, 16183, 16180, 16074, 16109, 16144, 16215, 15931, 15953,
        15892, 15912, 16121, 15871, 16054, 16184, 16240, 15609, 16195, 16191, 16191, 15805, 16231, 15966, 15786, 16191,
        16141, 16187, 16149, 15674, 16246, 15958, 16021, 16018, 15990, 16173, 15821, 15745, 15494, 16142, 16237, 15383,
        16171, 16213, 16200, 16251, 16016, 16180, 16150, 15929, 15746, 16131, 16120, 16148, 16250, 16201, 16224, 16155,
        16045, 15967, 16246, 16105, 15981, 16224, 16243, 16124, 16240, 16183, 16204, 16120, 16161, 16181, 16223, 16127,
        16022, 16216, 16217, 15943, 16158, 16197, 15448, 16249, 16049, 16220, 15895, 16199, 16251, 16252, 16116, 16192,
        16126, 15236, 16163, 16009, 16060, 16082, 15884, 16091, 16210, 16024, 15938, 16077, 16130, 15863, 15973, 16251,
        15816, 16079, 16220, 16145, 16249, 16047, 16245, 16201, 16232, 16082, 16198, 16055, 16042, 16076, 15782, 16026,
        16080, 16198, 15981, 16237, 15879, 16038, 15706, 16243, 16185, 15460, 15419, 16136, 16197, 16027, 15894, 16226,
        15778, 16000, 15799, 16173, 16172, 16207, 15995, 16093, 16087, 16192, 16142, 16212, 16220, 16066, 16186, 15813,
        16010, 16003, 15878, 16151, 15714, 16115, 16026, 16121, 16006, 16106, 16105, 16134, 16174, 16098, 16178, 16218,
        16017, 16093, 16066, 16211, 15929, 16130, 16201, 15792, 15720, 16168, 16178, 15955, 16199, 16216, 16199, 16174,
        16004, 15926, 16063, 15759, 16150, 15390, 16011, 16228, 16061, 15880, 15945, 16199, 16107, 16236, 15670, 16183,
        16204, 16123, 15773, 16112, 16132, 16225, 16029, 16122, 16147, 16084, 16245, 15922, 16165, 16115, 15632, 16200,
        16092, 16142, 16130, 15907, 16137, 15891, 16174, 16166, 16014, 16138, 15875, 16038, 16073, 15894, 16244, 15907,
        15935, 15876, 16231, 16148, 16139, 15804, 16105, 16233, 16225, 15785, 16106, 16204, 16185, 16224, 16076, 15807,
        16231, 16090, 16176, 16114, 16179, 16148, 16039, 16183, 16193, 15581, 16162, 16187, 15989, 16196, 15908, 15392,
        16203, 16029, 16245, 15982, 16106, 16128, 16151, 16244, 16219, 16142, 16106, 15815, 16243, 16159, 16147, 16220,
        16210, 15905, 16232, 16254, 16208, 15790, 15907, 15809, 16160, 16162, 16075, 16243, 15744, 16239, 16089, 16101,
        16004, 16186, 16217, 16190, 15624, 16029, 16245, 15861, 16053, 16099, 16054, 16072, 15493, 16136, 15933, 16216,
        16077, 16137, 16237, 16174, 15820, 16155, 16241, 15817, 16222, 15804, 16104, 15717, 16039, 15793, 15982, 15986,
        16157, 16214, 15623, 16133, 15487, 16131, 16091, 16166, 15755, 16139, 16000, 15620, 15970, 16148, 16001, 16197,
        15878, 16064, 15429, 16123, 15852, 16251, 16158, 15994, 16249, 16063, 16253, 15675, 16081, 16030, 15910, 16212,
        16163, 16206, 16123, 16163, 16253, 16060, 15749, 16032, 16200, 16205, 16019, 15760, 15991, 16174, 16169, 16066,
    },
    {
        16140, 16151, 16183, 16216, 16154, 16219, 16139, 16216, 16088, 16159, 16165, 16068, 16096, 16024, 16228, 15720,
        16246, 16011, 16068, 16116, 16202, 16207, 16135, 16117, 16145, 16073, 16236, 16214, 15761, 16044, 15794, 16165,
        15525, 16060, 16213, 16245, 16199, 15887, 16222, 16222, 16250, 16114, 16204, 16205, 16108, 16133, 16199, 16173,
        15858, 16184, 16163, 16148, 15890, 16137, 16241, 16194, 16133, 15832, 16084, 16114, 16007, 15934, 16198, 16188,
        16105, 15965, 16145, 15882, 15513, 16037, 16158, 15897, 16156, 15971, 16157, 16069, 16241, 16231, 16174, 16102,
        16056, 16156, 16095, 16231, 16178, 15819, 15734, 16248, 16170, 16167, 16171, 15919, 15959, 16055, 15876, 16192,
        16033, 16155, 16058, 16038, 16145, 15645, 16096, 16162, 16253, 16245, 15824, 16167, 15957, 16162, 15909, 16254,
        16167, 16148, 16001, 16084, 16110, 16115, 15994, 16159, 15906, 16045, 15842, 16172, 16168, 16034, 15885, 16199,
        15945, 16243, 16060, 16169, 16210, 15454, 15814, 16159, 16214, 16172, 15812, 16248, 16249, 16224, 16111, 16130,
        16250, 15716, 16154, 16102, 16189, 15523, 15648, 16098, 16016, 16250, 15862, 16056, 16023, 16118, 15859, 16176,
        16034, 16225, 16084, 16235, 15747, 15966, 16177, 16144, 16145, 16221, 16007, 16130, 16133, 16234, 15808, 16235,
        16147, 15786, 16237, 16014, 16035, 15385, 16170, 16215, 15878, 16165, 16183, 16215, 16020, 16007, 15931, 16075,
        16150, 16141, 15524, 15912, 16212, 16061, 15257, 15893, 16173, 16145, 16010, 16180, 16188, 16019, 16246, 16093,
        15998, 16193, 16147, 16074, 16151, 16229, 16146, 16163, 15972, 16228, 16243, 16174, 16100, 16101, 16216, 16250,
        16179, 15853, 16024, 16196, 16208, 16082, 16075, 16172, 16225, 15999, 16148, 16032, 16225, 16247, 16177, 16150,
        16185, 16168, 16128, 16136, 16244, 15980, 16164, 16074, 16089, 16158, 16155, 16115, 15517, 16112, 16026, 16183,
        16169, 16019, 16020, 16068, 16158, 16191, 16091, 16224, 15882, 15826, 16024, 15805, 16145, 16053, 16151, 16141,
        16147, 15625, 16167, 16248, 16166, 16036, 16092, 15970, 16229, 15888, 16060, 15815, 16095, 16251, 16228, 16005,
        16206, 16137, 16180, 16101, 15821, 15819, 16235, 16052, 16182, 16112, 16255, 16215, 15897, 16231, 16222, 15641,
        15910, 16130, 16157, 15914, 15869, 16199, 16217, 16221, 16206, 16082, 16145, 15887, 16080, 15624, 15757, 16251,
        16178, 16063, 16104, 16087, 16184, 15695, 16221, 16059, 16249, 15496, 16219, 15980, 15423, 16195, 16056, 16241,
        16186, 16191, 15919, 16045, 16133, 16122, 15710, 16045, 15948, 15927, 15511, 15919, 16203, 16109, 15973, 16223,
        16048, 16241, 16237, 16155, 16180, 16152, 15618, 16200, 15912, 16128, 16159, 15694, 16147, 16178, 15987, 16254,
        16239, 16008, 16157, 16173, 16137, 16221, 16151, 16192, 16186, 16246, 16031, 16141, 16075, 15961, 15958, 15971,
        15934, 15967, 16241, 16145, 16189, 16103, 16123, 16248, 15976, 16174, 16002, 15790, 15725, 15719, 16094, 16121,
        16031, 16225, 16178, 16249, 16065, 16158, 15927, 16138, 15562, 16218, 15753, 16190, 16173, 16117, 16104, 16173,
        16137, 16155, 16229, 16182, 16253, 16112, 15966, 16105, 16169, 16232, 16006, 15884, 15529, 15978, 16194, 16225,
        16035, 16231, 16068, 16165, 16150, 16038, 16212, 16133, 16161, 14440, 16223, 16031, 16012, 16089, 16204, 16226,
        15934, 16174, 16243, 16105, 16175, 16119, 15964, 16201, 16242, 15978, 16187, 16225, 16002, 16032, 15962, 16245,
        16132, 16113, 15570, 16182, 15956, 15901, 16089, 16186, 16063, 16165, 16109, 15964, 16014, 15934, 16150, 16206,
        16221, 16191, 15856, 16172, 16132, 16013, 15879, 15923, 16183, 16180, 16074, 16109, 16144, 16215, 15931, 15953,
        15892, 15912, 16121, 15871, 16054, 16184, 16240, 15609, 16195, 16191, 16191, 15805, 16231, 15966, 15786, 16191,
        16141, 16187, 16149, 15674, 16246, 15958, 16021, 16018, 15990, 16173, 15821, 15745, 15494, 16142, 16237, 15383,
        16171, 16213, 16200, 16251, 16016, 16180, 16150, 15929, 15746, 16131, 16120, 16148, 16250, 16201, 16224, 16155,
        16045, 15967, 16246, 16105, 15981, 16224, 16243, 16124, 16240, 16183, 16204, 16120, 16161, 16181, 16223, 16127,
        16022, 16216, 16217, 15943, 16158, 16197, 15448, 16249, 16049, 16220, 15895, 16199, 16251, 16252, 16116, 16192,
        16126, 15236, 16163, 16009, 16060, 16082, 15884, 16091, 16210, 16024, 15938, 16077, 16130, 15863, 15973, 16251,
        15816, 16079, 16220, 16145, 16249, 16047, 16245, 16201, 16232, 16082, 16198, 16055, 16042, 16076, 15782, 16026,
        16080, 16198, 15981, 16237, 15879, 16038, 15706, 16243, 16185, 15460, 15419, 16136, 16197, 16027, 15894, 16226,
        15778, 16000, 15799, 16173, 16172, 16207, 15995, 16093, 16087, 16192, 16142, 16212, 16220, 16066, 16186, 15813,
        16010, 16003, 15878, 16151, 15714, 16115, 16026, 16121, 16006, 16106, 16105, 16134, 16174, 16098, 16178, 16218,
        16017, 16093, 16066, 16211, 15929, 16130, 16201, 15792, 15720, 16168, 16178, 15955, 16199, 16216, 16199, 16174,
        16004, 15926, 16063, 15759, 16150, 15390, 16011, 16228, 16061, 15880, 15945, 16199, 16107, 16236, 15670, 16183,
        16204, 16123, 15773, 16112, 16132, 16225, 16029, 16122, 16147, 16084, 16245, 15922, 16165, 16115, 15632, 16200,
        16092, 16142, 16130, 15907, 16137, 15891, 16174, 16166, 16014, 16138, 15875, 16038, 16073, 15894, 16244, 15907,
        15935, 15876, 16231, 16148, 16139, 15804, 16105, 16233, 16225, 15785, 16106, 16204, 16185, 16224, 16076, 15807,
        16231, 16090, 16176, 16114, 16179, 16148, 16039, 16183, 16193, 15581, 16162, 16187, 15989, 16196, 15908, 15392,
        16203, 16029, 16245, 15982, 16106, 16128, 16151, 16244, 16219, 16142, 16106, 15815, 16243, 16159, 16147, 16220,
        16210, 15905, 16232, 16254, 16208, 15790, 15907, 15809, 16160, 16162, 16075, 16243, 15744, 16239, 16089, 16101,
        16004, 16186, 16217, 16190, 15624, 16029, 16245, 15861, 16053, 16099, 16054, 16072, 15493, 16136, 15933, 16216,
        16077, 16137, 16237, 16174, 15820, 16155, 16241, 15817, 16222, 15804, 16104, 15717, 16039, 15793, 15982, 15986,
        16157, 16214, 15623, 16133, 15487, 16131, 16091, 16166, 15755, 16139, 16000, 15620, 15970, 16148, 16001, 16197,
        15878, 16064, 15429, 16123, 15852, 16251, 16158, 15994, 16249, 16063, 16253, 15675, 16081, 16030, 15910, 16212,
        16163, 16206, 16123, 16163, 16253, 16060, 15749, 16032, 16200, 16205, 16019, 15760, 15991, 16174, 16169, 16066,
        15995, 16162, 16170, 16237, 16132, 16218, 16089, 16126, 16142, 16091, 16018, 16210, 16180, 16188, 16084, 16100,
        16056, 16248, 16212, 16057, 16236, 16075, 15676, 16189, 15982, 16101, 16050, 16239, 16208, 16003, 16252, 16067,
        16248, 16178, 16231, 16229, 16023, 15863, 16253, 15991, 15999, 15977, 15832, 16122, 16243, 16228, 15983, 16055,
        16176, 16069, 15727, 16234, 16187, 15849, 16225, 16161, 16011, 15880, 16066, 16063, 16063, 16038, 16191, 16174,
        15987, 16203, 15919, 16129, 16102, 16023, 16027, 16226, 16214, 16052, 15987, 16189, 16128, 16142, 16241, 15950,
        16162, 16140, 16222, 16133, 16240, 16050, 16192, 15561, 16179, 15896, 16247, 15879, 16254, 16181, 16103, 16181,
        15761, 16156, 16021, 16172, 15900, 16101, 16085, 16178, 15878, 16065, 16154, 15820, 16067, 16245, 16229, 15764,
        16247, 15518, 16140, 16250, 16012, 15896, 16151, 16004, 16229, 15964, 16080, 16148, 16141, 16249, 16011, 16011,
        16105, 16248, 16077, 15568, 15998, 16227, 16129, 16181, 16030, 16014, 16062, 16229, 16134, 15577, 16192, 16160,
        16042, 16040, 16236, 16247, 16220, 15916, 15687, 16230, 16001, 16040, 16100, 16227, 15830, 16131, 16050, 16130,
        16189, 16070, 16174, 16135, 16159, 16241, 16181, 16228, 15953, 16173, 16046, 16163, 16173, 16140, 16225, 16011,
        16139, 15895, 16016, 16219, 15607, 16162, 16181, 16025, 15361, 16107, 16062, 15560, 16135, 16142, 16236, 16056,
        15799, 16128, 16079, 15901, 15559, 16089, 16047, 16231, 16159, 15371, 16014, 16248, 15958, 16176, 15852, 15819,
        16147, 16020, 16177, 16138, 16172, 16185, 16242, 16071,
    }

};
static std::vector<std::vector<bfloat16>> ref_weight_out = {
    {16140, 16151, 16183, 16216, 16154, 16219, 16139, 16216, 16088, 16156, 15971, 16157, 16069, 16241, 16231, 16174,
     16102, 16056, 16250, 15716, 16154, 16102, 16189, 15523, 15648, 16098, 16016, 15972, 16228, 16243, 16174, 16100,
     16101, 16216, 16250, 16179, 16206, 16137, 16180, 16101, 15821, 15819, 16235, 16052, 16182, 15912, 16128, 16159,
     15694, 16147, 16178, 15987, 16254, 16239, 16035, 16231, 16068, 16165, 16150, 16038, 16212, 16133, 16161, 16195,
     16191, 16191, 15805, 16231, 15966, 15786, 16191, 16141, 16159, 16165, 16068, 16096, 16024, 16228, 15720, 16246,
     16011, 16156, 16095, 16231, 16178, 15819, 15734, 16248, 16170, 16167, 16250, 15862, 16056, 16023, 16118, 15859,
     16176, 16034, 16225, 15853, 16024, 16196, 16208, 16082, 16075, 16172, 16225, 15999, 16112, 16255, 16215, 15897,
     16231, 16222, 15641, 15910, 16130, 16008, 16157, 16173, 16137, 16221, 16151, 16192, 16186, 16246, 14440, 16223,
     16031, 16012, 16089, 16204, 16226, 15934, 16174, 16187, 16149, 15674, 16246, 15958, 16021, 16018, 15990, 16173,
     16068, 16116, 16202, 16207, 16135, 16117, 16145, 16073, 16236, 16171, 15919, 15959, 16055, 15876, 16192, 16033,
     16155, 16058, 16084, 16235, 15747, 15966, 16177, 16144, 16145, 16221, 16007, 16148, 16032, 16225, 16247, 16177,
     16150, 16185, 16168, 16128, 16157, 15914, 15869, 16199, 16217, 16221, 16206, 16082, 16145, 16031, 16141, 16075,
     15961, 15958, 15971, 15934, 15967, 16241, 16243, 16105, 16175, 16119, 15964, 16201, 16242, 15978, 16187, 15821,
     15745, 15494, 16142, 16237, 15383, 16171, 16213, 16200, 16214, 15761, 16044, 15794, 16165, 15525, 16060, 16213,
     16245, 16038, 16145, 15645, 16096, 16162, 16253, 16245, 15824, 16167, 16130, 16133, 16234, 15808, 16235, 16147,
     15786, 16237, 16014, 16136, 16244, 15980, 16164, 16074, 16089, 16158, 16155, 16115, 15887, 16080, 15624, 15757,
     16251, 16178, 16063, 16104, 16087, 16145, 16189, 16103, 16123, 16248, 15976, 16174, 16002, 15790, 16225, 16002,
     16032, 15962, 16245, 16132, 16113, 15570, 16182, 16251, 16016, 16180, 16150, 15929, 15746, 16131, 16120, 16148,
     16199, 15887, 16222, 16222, 16250, 16114, 16204, 16205, 16108, 15957, 16162, 15909, 16254, 16167, 16148, 16001,
     16084, 16110, 16035, 15385, 16170, 16215, 15878, 16165, 16183, 16215, 16020, 15517, 16112, 16026, 16183, 16169,
     16019, 16020, 16068, 16158, 16184, 15695, 16221, 16059, 16249, 15496, 16219, 15980, 15423, 15725, 15719, 16094,
     16121, 16031, 16225, 16178, 16249, 16065, 15956, 15901, 16089, 16186, 16063, 16165, 16109, 15964, 16014, 16250,
     16201, 16224, 16155, 16045, 15967, 16246, 16105, 15981, 16133, 16199, 16173, 15858, 16184, 16163, 16148, 15890,
     16137, 16115, 15994, 16159, 15906, 16045, 15842, 16172, 16168, 16034, 16007, 15931, 16075, 16150, 16141, 15524,
     15912, 16212, 16061, 16191, 16091, 16224, 15882, 15826, 16024, 15805, 16145, 16053, 16195, 16056, 16241, 16186,
     16191, 15919, 16045, 16133, 16122, 16158, 15927, 16138, 15562, 16218, 15753, 16190, 16173, 16117, 15934, 16150,
     16206, 16221, 16191, 15856, 16172, 16132, 16013, 16224, 16243, 16124, 16240, 16183, 16204, 16120, 16161, 16181,
     16241, 16194, 16133, 15832, 16084, 16114, 16007, 15934, 16198, 15885, 16199, 15945, 16243, 16060, 16169, 16210,
     15454, 15814, 15257, 15893, 16173, 16145, 16010, 16180, 16188, 16019, 16246, 16151, 16141, 16147, 15625, 16167,
     16248, 16166, 16036, 16092, 15710, 16045, 15948, 15927, 15511, 15919, 16203, 16109, 15973, 16104, 16173, 16137,
     16155, 16229, 16182, 16253, 16112, 15966, 15879, 15923, 16183, 16180, 16074, 16109, 16144, 16215, 15931, 16223,
     16127, 16022, 16216, 16217, 15943, 16158, 16197, 15448, 16188, 16105, 15965, 16145, 15882, 15513, 16037, 16158,
     15897, 16159, 16214, 16172, 15812, 16248, 16249, 16224, 16111, 16130, 16093, 15998, 16193, 16147, 16074, 16151,
     16229, 16146, 16163, 15970, 16229, 15888, 16060, 15815, 16095, 16251, 16228, 16005, 16223, 16048, 16241, 16237,
     16155, 16180, 16152, 15618, 16200, 16105, 16169, 16232, 16006, 15884, 15529, 15978, 16194, 16225, 15953, 15892,
     15912, 16121, 15871, 16054, 16184, 16240, 15609, 16249, 16049, 16220, 15895, 16199, 16251, 16252, 16116, 16192},
    {
        16140, 16171, 16035, 16159, 16038, 16007, 16068, 15957, 15257, 16151, 15919, 15385, 16165, 16145, 15931, 16116,
        16162, 15893, 16183, 15959, 16170, 16068, 15645, 16075, 16202, 15909, 16173, 16216, 16055, 16215, 16096, 16096,
        16150, 16207, 16254, 16145, 16154, 15876, 15878, 16024, 16162, 16141, 16135, 16167, 16010, 16219, 16192, 16165,
        16228, 16253, 15524, 16117, 16148, 16180, 16139, 16033, 16183, 15720, 16245, 15912, 16145, 16001, 16188, 16216,
        16155, 16215, 16246, 15824, 16212, 16073, 16084, 16019, 16088, 16058, 16020, 16011, 16167, 16061, 16236, 16110,
        16246, 16151, 15912, 16243, 15970, 16008, 16225, 16206, 16031, 15956, 16141, 16128, 16105, 16229, 16157, 16002,
        16137, 16141, 15901, 16147, 16159, 16175, 15888, 16173, 16032, 16180, 16075, 16089, 15625, 15694, 16119, 16060,
        16137, 15962, 16101, 15961, 16186, 16167, 16147, 15964, 15815, 16221, 16245, 15821, 15958, 16063, 16248, 16178,
        16201, 16095, 16151, 16132, 15819, 15971, 16165, 16166, 15987, 16242, 16251, 16192, 16113, 16235, 15934, 16109,
        16036, 16254, 15978, 16228, 16186, 15570, 16052, 15967, 15964, 16092, 16239, 16187, 16005, 16246, 16182, 16182,
        16241, 16014, 16250, 15995, 15935, 16224, 15813, 15785, 16223, 16006, 16176, 16201, 16093, 15876, 16243, 16010,
        16106, 16127, 16106, 16114, 16224, 16087, 16231, 16124, 16003, 16204, 16022, 16105, 16179, 16155, 16192, 16148,
        16240, 15878, 16185, 16216, 16134, 16148, 16045, 16142, 16139, 16183, 16151, 16224, 16217, 16174, 16039, 15967,
        16212, 15804, 16204, 15714, 16076, 15943, 16098, 16183, 16246, 16220, 16105, 16120, 16115, 15807, 16158, 16178,
        16193, 16105, 16066, 16233, 16161, 16026, 16231, 16197, 16218, 15581, 15981, 16186, 16225, 16181, 16121, 16090,
        15448, 16017, 16162, 16214, 16115, 16093, 16199, 15885, 15972, 16133, 16159, 15853, 15761, 15994, 15998, 15887,
        16199, 16228, 16199, 16214, 16024, 16044, 16159, 16193, 16222, 15945, 16243, 16173, 16172, 16196, 15794, 15906,
        16147, 16222, 16243, 16174, 15858, 15812, 16208, 16165, 16045, 16074, 16250, 16060, 16100, 16184, 16248, 16082,
        15525, 15842, 16151, 16114, 16169, 16101, 16163, 16249, 16075, 16060, 16172, 16229, 16204, 16210, 16216, 16148,
        16224, 16172, 16213, 16168, 16146, 16205, 15454, 16250, 15890, 16111, 16225, 16245, 16034, 16163, 16108, 15814,
        16179, 16137, 16130, 15999, 16112, 16145, 15934, 16157, 15725, 15879, 15887, 16158, 15953, 16255, 16189, 16150,
        15914, 15719, 15923, 16080, 15927, 15892, 16215, 16103, 16206, 15869, 16094, 16183, 15624, 16138, 15912, 15897,
        16123, 16221, 16199, 16121, 16180, 15757, 15562, 16121, 16231, 16248, 16191, 16217, 16031, 16074, 16251, 16218,
        15871, 16222, 15976, 15856, 16221, 16225, 16109, 16178, 15753, 16054, 15641, 16174, 16172, 16206, 16178, 16144,
        16063, 16190, 16184, 15910, 16002, 16132, 16082, 16249, 16215, 16104, 16173, 16240, 16130, 15790, 16013, 16145,
        16065, 15931, 16087, 16117, 15609, 16249, 16093, 16187, 16126, 16178, 16106, 16024, 15759, 16159, 16049, 16066,
        15989, 15236, 15955, 16128, 15938, 16150, 16147, 16220, 16211, 16196, 16163, 16199, 16151, 16077, 15390, 16220,
        15895, 15929, 15908, 16009, 16216, 16244, 16130, 16011, 16210, 16199, 16130, 15392, 16060, 16199, 16219, 15863,
        16228, 15905, 16251, 16201, 16203, 16082, 16174, 16142, 15973, 16061, 16232, 16252, 15792, 16029, 15884, 16004,
        16106, 16251, 15880, 16254, 16116, 15720, 16245, 16091, 15926, 15815, 15816, 15945, 16208, 16192, 16168, 15982,
        16210, 16063, 16243, 16079, 16199, 15790, 16241, 16250, 16148, 16188, 16250, 16136, 16156, 16084, 15517, 16194,
        15716, 16032, 16105, 15862, 16244, 15971, 16235, 16112, 16133, 16154, 16225, 15965, 16056, 15980, 16157, 15747,
        16026, 15832, 16102, 16247, 16145, 16023, 16164, 16069, 15966, 16183, 16084, 16189, 16177, 15882, 16118, 16074,
        16241, 16177, 16169, 16114, 15523, 16150, 15513, 15859, 16089, 16231, 16144, 16019, 16007, 15648, 16185, 16037,
        16176, 16158, 16174, 16145, 16020, 15934, 16098, 16168, 16158, 16034, 16155, 16102, 16221, 16068, 16198, 16016,
        16128, 15897, 16225, 16115, 16056, 16007, 16158, 16184, 16104, 16195, 16195, 16105, 16187, 15710, 16035, 15821,
        15695, 16173, 16191, 16056, 16169, 16149, 16045, 16231, 15745, 16221, 16137, 16191, 16241, 16232, 15674, 15948,
        16068, 15494, 16059, 16155, 15805, 16186, 16006, 16246, 15927, 16165, 16142, 16249, 16229, 16231, 16191, 15884,
        15958, 15511, 16150, 16237, 15496, 16182, 15966, 15919, 15529, 16021, 15919, 16038, 15383, 16219, 16253, 15786,
        16045, 15978, 16018, 16203, 16212, 16171, 15980, 16112, 16191, 16133, 16194, 15990, 16109, 16133, 16213, 15423,
        15966, 16141, 16122, 16225, 16173, 15973, 16161, 16200, 16220, 16107, 15907, 16055, 16225, 16101, 15879, 15632,
        16053, 16145, 16236, 15809, 16042, 16029, 16004, 16038, 16200, 16099, 16249, 15670, 16160, 16076, 16122, 16186,
        15706, 16092, 16054, 16047, 16183, 16162, 15782, 16147, 16217, 16243, 16142, 16072, 16245, 16204, 16075, 16026,
        16084, 16190, 16185, 16130, 15493, 16201, 16123, 16243, 16080, 16245, 15624, 15460, 15907, 16136, 16232, 15773,
        15744, 16198, 15922, 16029, 15419, 16137, 15933, 16082, 16112, 16239, 15981, 16165, 16245, 16136, 15891, 16216,
        16198, 16132, 16089, 16237, 16115, 15861, 16197, 16174, 16077,
    },
    {
        16140, 16156, 16151, 15971, 16183, 16157, 16216, 16069, 16154, 16241, 16219, 16231, 16139, 16174, 16216, 16102,
        16088, 16056, 16250, 15972, 15716, 16228, 16154, 16243, 16102, 16174, 16189, 16100, 15523, 16101, 15648, 16216,
        16098, 16250, 16016, 16179, 16206, 15912, 16137, 16128, 16180, 16159, 16101, 15694, 15821, 16147, 15819, 16178,
        16235, 15987, 16052, 16254, 16182, 16239, 16035, 16195, 16231, 16191, 16068, 16191, 16165, 15805, 16150, 16231,
        16038, 15966, 16212, 15786, 16133, 16191, 16161, 16141, 16126, 16006, 15236, 16106, 16163, 16105, 16009, 16134,
        16060, 16174, 16082, 16098, 15884, 16178, 16091, 16218, 16210, 16017, 16159, 16156, 16165, 16095, 16068, 16231,
        16096, 16178, 16024, 15819, 16228, 15734, 15720, 16248, 16246, 16170, 16011, 16167, 16250, 15853, 15862, 16024,
        16056, 16196, 16023, 16208, 16118, 16082, 15859, 16075, 16176, 16172, 16034, 16225, 16225, 15999, 16112, 16008,
        16255, 16157, 16215, 16173, 15897, 16137, 16231, 16221, 16222, 16151, 15641, 16192, 15910, 16186, 16130, 16246,
        14440, 16187, 16223, 16149, 16031, 15674, 16012, 16246, 16089, 15958, 16204, 16021, 16226, 16018, 15934, 15990,
        16174, 16173, 16024, 16093, 15938, 16066, 16077, 16211, 16130, 15929, 15863, 16130, 15973, 16201, 16251, 15792,
        15816, 15720, 16079, 16168, 16068, 16171, 16116, 15919, 16202, 15959, 16207, 16055, 16135, 15876, 16117, 16192,
        16145, 16033, 16073, 16155, 16236, 16058, 16084, 16148, 16235, 16032, 15747, 16225, 15966, 16247, 16177, 16177,
        16144, 16150, 16145, 16185, 16221, 16168, 16007, 16128, 16157, 16031, 15914, 16141, 15869, 16075, 16199, 15961,
        16217, 15958, 16221, 15971, 16206, 15934, 16082, 15967, 16145, 16241, 16243, 15821, 16105, 15745, 16175, 15494,
        16119, 16142, 15964, 16237, 16201, 15383, 16242, 16171, 15978, 16213, 16187, 16200, 16220, 16178, 16145, 15955,
        16249, 16199, 16047, 16216, 16245, 16199, 16201, 16174, 16232, 16004, 16082, 15926, 16198, 16063, 16214, 16038,
        15761, 16145, 16044, 15645, 15794, 16096, 16165, 16162, 15525, 16253, 16060, 16245, 16213, 15824, 16245, 16167,
        16130, 16136, 16133, 16244, 16234, 15980, 15808, 16164, 16235, 16074, 16147, 16089, 15786, 16158, 16237, 16155,
        16014, 16115, 15887, 16145, 16080, 16189, 15624, 16103, 15757, 16123, 16251, 16248, 16178, 15976, 16063, 16174,
        16104, 16002, 16087, 15790, 16225, 16251, 16002, 16016, 16032, 16180, 15962, 16150, 16245, 15929, 16132, 15746,
        16113, 16131, 15570, 16120, 16182, 16148, 16055, 15759, 16042, 16150, 16076, 15390, 15782, 16011, 16026, 16228,
        16080, 16061, 16198, 15880, 15981, 15945, 16237, 16199, 16199, 15957, 15887, 16162, 16222, 15909, 16222, 16254,
        16250, 16167, 16114, 16148, 16204, 16001, 16205, 16084, 16108, 16110, 16035, 15517, 15385, 16112, 16170, 16026,
        16215, 16183, 15878, 16169, 16165, 16019, 16183, 16020, 16215, 16068, 16020, 16158, 16184, 15725, 15695, 15719,
        16221, 16094, 16059, 16121, 16249, 16031, 15496, 16225, 16219, 16178, 15980, 16249, 15423, 16065, 15956, 16250,
        15901, 16201, 16089, 16224, 16186, 16155, 16063, 16045, 16165, 15967, 16109, 16246, 15964, 16105, 16014, 15981,
        15879, 16107, 16038, 16236, 15706, 15670, 16243, 16183, 16185, 16204, 15460, 16123, 15419, 15773, 16136, 16112,
        16197, 16132,
    },
    {
        16140, 16159, 16159, 16250, 16068, 16250, 16151, 16214, 16165, 15716, 16116, 15862, 16183, 16172, 16068, 16154,
        16202, 16056, 16216, 15812, 16096, 16102, 16207, 16023, 16154, 16248, 16024, 16189, 16135, 16118, 16219, 16249,
        16228, 15523, 16117, 15859, 16139, 16224, 15720, 15648, 16145, 16176, 16216, 16111, 16246, 16098, 16073, 16034,
        16088, 16130, 16011, 16016, 16236, 16225, 16151, 16158, 15970, 16104, 16206, 16105, 16141, 15927, 16229, 16173,
        16137, 16169, 16147, 16138, 15888, 16137, 16180, 16232, 15625, 15562, 16060, 16155, 16101, 16006, 16167, 16218,
        15815, 16229, 15821, 15884, 16248, 15753, 16095, 16182, 15819, 15529, 16166, 16190, 16251, 16253, 16235, 15978,
        16036, 16173, 16228, 16112, 16052, 16194, 16092, 16117, 16005, 15966, 16182, 16225, 16250, 15759, 16224, 16107,
        16223, 16225, 16201, 16150, 16243, 16236, 16127, 16029, 16224, 15390, 16124, 15670, 16022, 16122, 16155, 16011,
        16240, 16183, 16216, 16147, 16045, 16228, 16183, 16204, 16217, 16084, 15967, 16061, 16204, 16123, 15943, 16245,
        16246, 15880, 16120, 15773, 16158, 15922, 16105, 15945, 16161, 16112, 16197, 16165, 15981, 16199, 16181, 16132,
        15448, 16115, 16104, 16140, 16133, 16247, 15970, 16172, 15717, 16222, 15487, 15879, 16148, 15900, 16039, 16133,
        16131, 16254, 16001, 16101, 15793, 16240, 16091, 16181, 16197, 16085, 15982, 16050, 16166, 16103, 15878, 16178,
        15986, 16192, 15755, 16181, 16064, 15878, 16157, 15561, 16139, 15761, 15429, 16065, 16214, 16179, 16000, 16156,
        16123, 16154, 15623, 15896, 15620, 16021, 15852, 15820, 16214, 16084, 16199, 16130, 16133, 16035, 15761, 16235,
        15887, 16133, 16199, 15385, 16044, 15747, 16222, 16234, 16173, 16170, 15794, 15966, 16222, 15808, 15858, 16215,
        16165, 16177, 16250, 16235, 16184, 15878, 15525, 16144, 16114, 16147, 16163, 16165, 16060, 16145, 16204, 15786,
        16148, 16183, 16213, 16221, 16205, 16237, 15890, 16215, 16245, 16007, 16108, 16014, 16137, 16020, 16112, 16035,
        16157, 14440, 15887, 16243, 16255, 16231, 15914, 16223, 16080, 16105, 16215, 16068, 15869, 16031, 15624, 16175,
        15897, 16165, 16199, 16012, 15757, 16119, 16231, 16150, 16217, 16089, 16251, 15964, 16222, 16038, 16221, 16204,
        16178, 16201, 15641, 16212, 16206, 16226, 16063, 16242, 15910, 16133, 16082, 15934, 16104, 15978, 16130, 16161,
        16145, 16174, 16087, 16187, 16249, 15632, 16126, 16166, 16024, 15935, 16049, 16200, 15236, 16014, 15938, 15876,
        16220, 16092, 16163, 16138, 16077, 16231, 15895, 16142, 16009, 15875, 16130, 16148, 16199, 16130, 16060, 16038,
        15863, 16139, 16251, 15907, 16082, 16073, 15973, 15804, 16252, 16137, 15884, 15894, 16251, 16105, 16116, 15891,
        16091, 16244, 15816, 16233, 16192, 16174, 16210, 15907, 16079, 16225, 16251, 16067, 15910, 15896, 16032, 16011,
        16158, 16245, 16212, 16151, 16200, 16011, 15994, 16229, 16163, 16004, 16205, 16105, 16249, 15764, 16206, 16229,
        16019, 16248, 16063, 16247, 16123, 15964, 15760, 16077, 16253, 15518, 16163, 16080, 15991, 15568, 15675, 16140,
        16253, 16148, 16174, 15998, 16081, 16250, 16060, 16141, 16169, 16227, 16030, 16012, 15749, 16249, 16066, 16129,
        16241, 16007, 16188, 15257, 16156, 16093, 16194, 15931, 16105, 15893, 15971, 15998, 16133, 16075, 15965, 16173,
        16157, 16193, 15832, 16150, 16145, 16145, 16069, 16147, 16084, 16141, 15882, 16010, 16241, 16074, 16114, 15524,
        15513, 16180, 16231, 16151, 16007, 15912, 16037, 16188, 16174, 16229, 15934, 16212, 16158, 16019, 16102, 16146,
        16198, 16061, 15897, 16246, 16056, 16163, 16184, 16225, 16195, 15956, 15710, 15934, 15695, 16002, 16056, 15901,
        16045, 16150, 16221, 16032, 16241, 16089, 15948, 16206, 16059, 15962, 16186, 16186, 15927, 16221, 16249, 16245,
        16191, 16063, 15511, 16191, 15496, 16132, 15919, 16165, 15919, 15856, 16219, 16113, 16045, 16109, 16203, 16172,
        15980, 15570, 16133, 15964, 16109, 16132, 15423, 16182, 16122, 16014, 15973, 16013, 16220, 15785, 16055, 16176,
        15879, 16187, 16145, 16106, 16042, 16114, 16038, 15989, 16249, 16204, 16076, 16179, 15706, 16196, 16047, 16185,
        15782, 16148, 16243, 15908, 16245, 16224, 16026, 16039, 16185, 15392, 16201, 16076, 16080, 16183, 15460, 16203,
        16232, 15807, 16198, 16193, 15419, 16029, 16082, 16231, 15981, 15581, 16136, 16245, 16198, 16090, 16237, 16162,
        16197, 15982, 15995, 16181, 16091, 16042, 16212, 16040, 16162, 16030, 16018, 16040, 16057, 16100, 16170, 16014,
        16210, 16236, 16236, 16227, 16237, 16062, 16180, 16247, 16075, 15830, 16132, 16229, 16188, 16220, 15676, 16131,
        16218, 16134, 16084, 15916, 16189, 16050, 16089, 15577, 16100, 15687, 15982, 16130, 16126, 16192, 16056, 16230,
        16101, 16189, 16142, 16160, 16248, 16001, 16050, 16070, 16156, 15972, 16171, 15853, 16038, 16148, 16095, 16228,
        15919, 16024, 16145, 16032, 16231, 16243, 15959, 16196, 15645, 16225, 16178, 16174, 16055, 16208, 16096, 16247,
        15819, 16100, 15876, 16082, 16162, 16177, 15734, 16101, 16192, 16075, 16253, 16150, 16248, 16216, 16033, 16172,
        16245, 16185, 16170, 16250, 16155, 16225, 15824, 16168, 16167, 16179, 16058, 15999, 16167, 16128, 16223, 15879,
        15912, 15953, 16008, 16195, 16048, 15923, 16128, 15892, 16157, 16191, 16241, 16183, 16159, 15912, 16173, 16191,
        16237, 16180, 15694, 16121, 16137, 15805, 16155, 16074, 16147, 15871, 16221, 16231, 16180, 16109, 16178, 16054,
        16151, 15966, 16152, 16144, 15987, 16184, 16192, 15786, 15618, 16215, 16254, 16240, 16186, 16191, 16200, 15931,
        16239, 15609, 16246, 16141, 16027, 16106, 15995, 16159, 15813, 15907, 15894, 16128, 16093, 16147, 16010, 15809,
        16226, 16151, 16087, 16220, 16003, 16160, 15778, 16244, 16192, 16210, 15878, 16162, 16000, 16219, 16142, 15905,
        16151, 16075, 15799, 16142, 16212, 16232, 15714, 16243, 16173, 16106, 16220, 16254, 16115, 15744, 16172, 15815,
        16066, 16208, 16026, 16239, 16207, 16243, 16186, 15790, 16121, 16089, 16239, 16174, 16023, 16163, 16228, 15607,
        16208, 16135, 15863, 16173, 15983, 16162, 16003, 16159, 16253, 16140, 16055, 16181, 16252, 16241, 15991, 16225,
        16176, 16025, 16067, 16181, 15999, 16011, 16069, 15361, 16248, 16228, 15977, 16139, 15727, 16107, 16178, 15953,
        15832, 15895, 16234, 16062, 16231, 16173, 16122, 16016, 16187, 15560, 16229, 16046, 16243, 16219, 15849, 16135,
    }};

static std::vector<tt::tt_metal::Array4D> weight_tensor_shape = {
    {8, 8, 3, 3}, {10, 10, 3, 3}, {12, 8, 3, 3}, {8, 15, 3, 3}};
static std::vector<tt::tt_metal::Array4D> bias_tensor_shape = {
    {1, 1, 1, 32}, {1, 1, 1, 60}, {12, 1, 1, 320}, {8, 1, 1, 48}};
static std::vector<uint32_t> shards = {8, 3, 5, 4};

template <typename T>
static uint32_t compare_out_with_ref(const owned_buffer::Buffer<bfloat16>& out_buf, T& ref) {
    uint32_t diff = 0, j = 0;
    for (uint32_t i = 0; i < out_buf.size(); i++) {
        if (out_buf[i] == 0) {
            continue;
        }
        if (out_buf[i] != ref[j]) {
            log_info(
                tt::LogTest,
                "Error at i = {}, Golden = {}, Calculated = {}",
                i,
                out_buf[i].to_float(),
                ref[j].to_float());
            diff++;
        }
        j++;
    }
    return diff;
}

static void test_convert_conv_weight_tensor_to_tiled_layout_block_sharded() {
    tt::log_info(tt::LogTest, "Running {}", __func__);
    for (auto i = 0; i < weight_tensor_shape.size(); i++) {
        auto input_tensor = ttnn::zeros(weight_tensor_shape[i]);
        auto input_buffer = owned_buffer::get_as<bfloat16>(input_tensor);
        for (auto j = 0; j < input_buffer.size(); j++) {
            input_buffer[j] = ref_weight_in[i][j];
        }
        auto output_tensor = ttnn::operations::conv::convert_conv_weight_tensor_to_tiled_layout_block_sharded(
            input_tensor, shards[i], DataType::BFLOAT16);
        auto out_buffer = owned_buffer::get_as<bfloat16>(output_tensor);

        TT_FATAL(compare_out_with_ref(out_buffer, ref_weight_out[i]) == 0, "Error");
    }
}

static void test_convert_conv_bias_tensor_to_tiled_layout_block_sharded() {
    tt::log_info(tt::LogTest, "Running {}", __func__);
    for (auto i = 0; i < bias_tensor_shape.size(); i++) {
        auto input_tensor = ttnn::random::random(bias_tensor_shape[i], DataType::BFLOAT16).to(Layout::ROW_MAJOR).cpu();
        auto input_buffer = owned_buffer::get_as<bfloat16>(input_tensor);
        auto output_tensor = ttnn::operations::conv::convert_conv_bias_tensor_to_tiled_layout_block_sharded(
            input_tensor, shards[i], DataType::BFLOAT16);
        auto out_buffer = owned_buffer::get_as<bfloat16>(output_tensor);
        /* Expected output should be same as input buffer except some padding*/
        TT_FATAL(compare_out_with_ref(out_buffer, input_buffer) == 0, "Error");
    }
}

int main() {
    tt::log_info(tt::LogTest, "Tests for Tensor utils starts");
    test_convert_conv_weight_tensor_to_tiled_layout_block_sharded();
    test_convert_conv_bias_tensor_to_tiled_layout_block_sharded();
    tt::log_info(tt::LogTest, "Tests for Tensor utils ends");
    return 0;
}
