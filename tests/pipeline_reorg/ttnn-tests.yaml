# =============================================================================
# Shared TTNN Test Definitions
# =============================================================================
# This file defines all TTNN unit test groups used by both:
#   - ttnn-post-commit.yaml (hardware CI)
#   - ttsim.yaml (simulator CI)
#
# Each test group can have the following fields:
#   - name: Display name for the test group (required)
#   - cmd: The pytest command to run (required)
#   - timeout: GHA job-level timeout in minutes (required)
#   - merge_gate: If true, run during merge-gate (default: false)
#   - ttsim: If true, can run on TTSim simulator (default: true)
#   - fast_runtime_mode_off: If true, disable fast runtime mode (default: false)
# =============================================================================

tests:
  # ---------------------------------------------------------------------------
  # Example tests
  # ---------------------------------------------------------------------------
  - name: "ttnn example tests"
    cmd: "./tests/scripts/run_ttnn_examples.sh"
    timeout: 15
    merge_gate: true
    ttsim: false  # Examples use features not supported in simulator

  # ---------------------------------------------------------------------------
  # Eltwise operation tests (split into 5 groups for parallelization)
  # ---------------------------------------------------------------------------
  - name: "ttnn eltwise group 1"
    cmd: 'pytest --timeout 300 tests/ttnn/unit_tests/operations/eltwise -xv --splits 5 --group 1 -m "not disable_fast_runtime_mode"'
    timeout: 15
    merge_gate: false
    ttsim: true

  - name: "ttnn eltwise group 2"
    cmd: 'pytest --timeout 300 tests/ttnn/unit_tests/operations/eltwise -xv --splits 5 --group 2 -m "not disable_fast_runtime_mode"'
    timeout: 15
    merge_gate: false
    ttsim: true

  - name: "ttnn eltwise group 3"
    cmd: 'pytest --timeout 300 tests/ttnn/unit_tests/operations/eltwise -xv --splits 5 --group 3 -m "not disable_fast_runtime_mode"'
    timeout: 15
    merge_gate: false
    ttsim: true

  - name: "ttnn eltwise group 4"
    cmd: 'pytest --timeout 300 tests/ttnn/unit_tests/operations/eltwise -xv --splits 5 --group 4 -m "not disable_fast_runtime_mode"'
    timeout: 15
    merge_gate: false
    ttsim: true

  - name: "ttnn eltwise group 5"
    cmd: 'pytest --timeout 300 tests/ttnn/unit_tests/operations/eltwise -xv --splits 5 --group 5 -m "not disable_fast_runtime_mode"'
    timeout: 15
    merge_gate: false
    ttsim: true

  # ---------------------------------------------------------------------------
  # Convolution tests
  # ---------------------------------------------------------------------------
  - name: "ttnn conv group"
    cmd: 'pytest --timeout 300 tests/ttnn/unit_tests/operations/conv -xv -m "not disable_fast_runtime_mode"'
    timeout: 15
    merge_gate: false
    ttsim: true

  # ---------------------------------------------------------------------------
  # Pooling tests
  # ---------------------------------------------------------------------------
  - name: "ttnn pool group"
    cmd: 'pytest --timeout 300 tests/ttnn/unit_tests/operations/pool -xv -m "not disable_fast_runtime_mode"'
    timeout: 15
    merge_gate: false
    ttsim: true

  # ---------------------------------------------------------------------------
  # Matrix multiplication tests
  # ---------------------------------------------------------------------------
  - name: "ttnn matmul group"
    cmd: 'pytest --timeout 300 tests/ttnn/unit_tests/operations/matmul -xv -m "not disable_fast_runtime_mode"'
    timeout: 15
    merge_gate: false
    ttsim: true

  # ---------------------------------------------------------------------------
  # Fused operation tests
  # ---------------------------------------------------------------------------
  - name: "ttnn fused group"
    cmd: 'pytest --timeout 300 tests/ttnn/unit_tests/operations/fused -xv -m "not disable_fast_runtime_mode"'
    timeout: 15
    merge_gate: false
    ttsim: true

  # ---------------------------------------------------------------------------
  # Transformer operation tests
  # ---------------------------------------------------------------------------
  - name: "ttnn transformers group"
    cmd: 'pytest --timeout 300 tests/ttnn/unit_tests/operations/transformers -xv -m "not disable_fast_runtime_mode"'
    timeout: 15
    merge_gate: false
    ttsim: true

  # ---------------------------------------------------------------------------
  # SDPA / MLA operation tests
  # ---------------------------------------------------------------------------
  - name: "ttnn sdpa group"
    cmd: 'pytest --timeout 300 tests/ttnn/unit_tests/operations/sdpa -xv -m "not disable_fast_runtime_mode"'
    timeout: 15
    merge_gate: false
    ttsim: false  # SDPA tests require device

  # ---------------------------------------------------------------------------
  # Reduce and misc operation tests
  # ---------------------------------------------------------------------------
  - name: "ttnn reduce and misc ops group"
    cmd: 'pytest --timeout 300 tests/ttnn/unit_tests/operations/reduce tests/ttnn/unit_tests/operations/debug -xv -m "not disable_fast_runtime_mode"'
    timeout: 15
    merge_gate: false
    ttsim: true

  # ---------------------------------------------------------------------------
  # Core TTNN unit tests
  # ---------------------------------------------------------------------------
  - name: "core ttnn unit test group"
    cmd: 'pytest --timeout 300 tests/ttnn/unit_tests/base_functionality tests/ttnn/unit_tests/benchmarks tests/ttnn/unit_tests/tensor -xv -m "not disable_fast_runtime_mode"'
    timeout: 15
    merge_gate: false
    ttsim: true

  # ---------------------------------------------------------------------------
  # Fast runtime mode off tests (commented out in original)
  # ---------------------------------------------------------------------------
  # - name: "ttnn fast runtime off"
  #   cmd: 'pytest --timeout 300 tests/ttnn/unit_tests -xv -m requires_fast_runtime_mode_off'
  #   merge_gate: false
  #   fast_runtime_mode_off: true
  #   ttsim: false
