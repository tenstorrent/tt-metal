# This file defines the test matrix for the Galaxy e2e tests pipeline.

# Each entry represents a parallel job with the following keys:
#   name: The display name for the job in GitHub Actions.
#   cmd: The exact command to run for the test.
#   sku: Machine type to target (e.g. wh_galaxy, bh_galaxy).
#   owner_id: The Slack user ID to notify on failure.
#   team: The team that owns the test.
#   timeout: The maximum allowed runtime for this job in minutes.

# For max allowed timeout refer to .github/time_budget.yaml

# Wormhole Galaxy e2e tests
- name: galaxy_ccl_tests
  cmd: pytest tests/nightly/tg/ccl
  sku: wh_galaxy
  owner_id: U05ACKAJTHS # Naif Tarafdar
  team: ttnn
  timeout: 40

- name: galaxy_fabric_unit_tests
  cmd: build/test/tt_metal/tt_fabric/fabric_unit_tests --gtest_filter="NightlyFabric*Fixture.*"
  sku: wh_galaxy
  owner_id: U08UBDUKH6Z # Neel Nyamagoudar
  team: fabric
  timeout: 25

- name: galaxy_fabric_2d_torus_nightly_tests
  cmd: ./build/test/tt_metal/perf_microbenchmark/routing/test_tt_fabric --test_config tests/tt_metal/tt_metal/perf_microbenchmark/routing/test_fabric_2d_torus_nightly.yaml
  sku: wh_galaxy
  owner_id: U08UBDUKH6Z # Neel Nyamagoudar
  team: fabric
  timeout: 45

- name: galaxy_fabric_multi_mesh_4x4_2x4s_stability_tests
  cmd: python tests/tt_metal/tt_fabric/utils/generate_rank_bindings.py && tt-run --rank-binding 4x4_2x4_3_mesh_rank_binding.yaml --mpi-args "--allow-run-as-root --tag-output" ./build/test/tt_metal/perf_microbenchmark/routing/test_tt_fabric --test_config tests/tt_metal/tt_metal/perf_microbenchmark/routing/test_fabric_multi_mesh_stability_short_running.yaml
  sku: wh_galaxy
  owner_id: U08UBDUKH6Z # Neel Nyamagoudar
  team: fabric
  timeout: 15

- name: galaxy_fabric_multi_mesh_2x8_2x4s_stability_tests
  cmd: python tests/tt_metal/tt_fabric/utils/generate_rank_bindings.py && tt-run --rank-binding 2x8_2x4_3_mesh_rank_binding.yaml --mpi-args "--allow-run-as-root --tag-output" ./build/test/tt_metal/perf_microbenchmark/routing/test_tt_fabric --test_config tests/tt_metal/tt_metal/perf_microbenchmark/routing/test_fabric_multi_mesh_stability_short_running.yaml
  sku: wh_galaxy
  owner_id: U08UBDUKH6Z # Neel Nyamagoudar
  team: fabric
  timeout: 15

# Blackhole Galaxy e2e tests
- name: bh_galaxy_ccl_tests
  cmd: pytest tests/ttnn/unit_tests/operations/ccl/blackhole_CI/galaxy/galaxy_nightly
  sku: bh_galaxy
  owner_id: U05ACKAJTHS # Naif Tarafdar, Camilo Vega
  team: ttnn
  timeout: 40

- name: bh_galaxy_fabric_unit_tests
  cmd: build/test/tt_metal/tt_fabric/fabric_unit_tests --gtest_filter="NightlyFabric*Fixture.*"
  sku: bh_galaxy
  owner_id: U08UBDUKH6Z # Neel Nyamagoudar
  team: fabric
  timeout: 30

- name: bh_galaxy_fabric_torus_stability_tests
  cmd: ./build/test/tt_metal/perf_microbenchmark/routing/test_tt_fabric --test_config tests/tt_metal/tt_metal/perf_microbenchmark/routing/test_bh_glx_2d_torus_stability.yaml
  sku: bh_galaxy
  owner_id: U08UBDUKH6Z # Neel Nyamagoudar
  team: fabric
  timeout: 20
