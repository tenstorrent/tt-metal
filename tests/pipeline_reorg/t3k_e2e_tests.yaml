# This file defines the test matrix for the T3000 e2e tests pipeline.

# Each entry represents a parallel job with the following keys:
#   name: The display name for the job in GitHub Actions.
#   cmd: The exact command to run for the test.
#   skus: A mapping of SKU names to their configuration (each SKU has timeout in minutes).
#   owner_id: The Slack user ID to notify on failure.
#   team: The team that owns the test.

# For max allowed timeout refer to .github/time_budget.yaml

- name: t3k_ccl_tests
  cmd: pytest tests/nightly/t3000/ccl
  skus:
    wh_llmbox:
      timeout: 90
  owner_id: U05ACKAJTHS # Naif Tarafdar
  team: ttnn

- name: t3k_ccl_2d_tests
  cmd: TT_MESH_GRAPH_DESC_PATH=tests/tt_metal/tt_fabric/custom_mesh_descriptors/t3k_1x8_mesh_graph_descriptor.textproto pytest tests/nightly/t3000/2d_ccl
  skus:
    wh_llmbox:
      timeout: 10
  owner_id: U013121KDH9 # Austin Ho
  team: scaleout

- name: t3k_fabric_unit_tests
  cmd: build/test/tt_metal/tt_fabric/fabric_unit_tests --gtest_filter="NightlyFabric*Fixture.*"
  skus:
    wh_llmbox:
      timeout: 30
  owner_id: U08UBDUKH6Z # Neel Nyamagoudar
  team: fabric

- name: t3k_addrgen_write_tests
  cmd: build/test/tt_metal/tt_fabric/test_addrgen_write
  skus:
    wh_llmbox:
      timeout: 10
  owner_id: U08LD7UCKDF # Tomer Levin
  team: scaleout

- name: t3k_dispatch_unit_tests
  cmd: build/test/tt_metal/unit_tests_dispatch --gtest_filter="Large*.NIGHTLY_DRAMReadback/*"
  skus:
    wh_llmbox:
      timeout: 15
  owner_id: U07R05K4WGJ # John Bauman
  team: fabric

- name: t3k_fabric_stability_tests
  cmd: TT_METAL_CLEAR_L1=1 build/test/tt_metal/perf_microbenchmark/routing/test_tt_fabric --test_config tests/tt_metal/tt_metal/perf_microbenchmark/routing/test_fabric_stability.yaml
  skus:
    wh_llmbox:
      timeout: 120
  owner_id: U08FXFFH7L0 # Abhishek Agarwal
  team: fabric

- name: models_tttv2_mlp_modules_full_set_unit_tests
  cmd: HF_HUB_OFFLINE=1 HF_HOME=/mnt/MLPerf/huggingface HF_MODEL=meta-llama/Llama-3.1-8B-Instruct pytest --tb=short models/common/tests/modules/mlp
  skus:
    wh_llmbox:
      timeout: 35
  owner_id: U07RY6B5FLJ # Gongyu Wang
  team: models

- name: models_tttv2_rope_modules_full_set_unit_tests
  cmd: HF_HUB_OFFLINE=1 HF_HOME=/mnt/MLPerf/huggingface HF_MODEL=meta-llama/Llama-3.1-8B-Instruct pytest --tb=short models/common/tests/modules/rope
  skus:
    wh_llmbox:
      timeout: 5
  owner_id: U07RY6B5FLJ # Gongyu Wang
  team: models

- name: models_tttv2_llama31_8B_tests
  cmd: MESH_DEVICE=T3K HF_HUB_OFFLINE=1 HF_HOME=/mnt/MLPerf/huggingface HF_MODEL=meta-llama/Llama-3.1-8B-Instruct TT_CACHE_PATH=/mnt/MLPerf/huggingface/tt_cache/meta-llama--Llama-3.1-8B-Instruct pytest --tb=short models/common/demos/llama31_8B_demo.py
  skus:
    wh_llmbox:
      timeout: 15
  owner_id: U07RY6B5FLJ # Gongyu Wang
  team: models
