================================================================================
GRID STRATEGY COMPARISON: max_ab vs max_abc
================================================================================

OVERALL RESULTS (138 configurations)
--------------------------------------------------------------------------------
Mean difference:   -0.130 Î¼s (0.75%)   [max_abc slightly slower]
Median difference: -0.003 Î¼s (-0.01%)  [essentially identical]

max_ab faster:   69 cases (50.0%)
max_abc faster:  69 cases (50.0%)
Tied:            0 cases

Standard deviation: 8.358 Î¼s  [HIGH VARIANCE]


CRITICAL DISCOVERY
--------------------------------------------------------------------------------
ğŸ” ALL 138 configurations use IDENTICAL compute cores in both strategies!

   This means: Performance differences are NOT due to compute grid size

   Instead:    Differences are due to OUTPUT TENSOR SHARDING choices


PERFORMANCE BY OUTPUT SHARDING TYPE
--------------------------------------------------------------------------------
Output Type     â”‚ Cases â”‚  Avg Diff  â”‚ Winner
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
HEIGHT          â”‚  21   â”‚  +3.51%    â”‚ max_abc (slower)
WIDTH           â”‚  51   â”‚  -0.44%    â”‚ ~tie~
BLOCK           â”‚  50   â”‚  +0.53%    â”‚ ~tie~
INTERLEAVED     â”‚  16   â”‚  +1.61%    â”‚ max_ab (faster)


EXTREME CASES
--------------------------------------------------------------------------------

ğŸ† BEST for max_abc (40% faster):
   Config: 1Ã—1024 (interleaved) + 1024Ã—1024 (block,8) â†’ interleaved
   max_ab:  75.75 Î¼s
   max_abc: 45.17 Î¼s  â† 40.4% improvement

âŒ WORST for max_abc (112% slower):
   Config: 1Ã—1024 (interleaved) + 1024Ã—1024 (height,32) â†’ interleaved
   max_ab:  37.33 Î¼s  â† 112.1% faster!
   max_abc: 79.16 Î¼s

âš ï¸  ERROR in max_abc:
   Config: 1Ã—1024 (block,8) + 1024Ã—1024 (height,16) â†’ block
   Error: Invalid block sharding grid


PATTERN ANALYSIS
--------------------------------------------------------------------------------

max_abc EXCELS when:
âœ… Small tensor A (1Ã—1024) is interleaved
âœ… Output is interleaved (matches input locality)
âœ… Low to moderate core counts (8-16)
âœ… Memory locality is important

max_ab EXCELS when:
âœ… High parallelism (32 cores)
âœ… Height-sharded large tensors
âœ… Output sharding is flexible/doesn't matter
âœ… Predictable performance is needed


VARIANCE DISTRIBUTION
--------------------------------------------------------------------------------
  Difference Range        â”‚ Count â”‚  %
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€
  max_abc faster by >20%  â”‚  10   â”‚  7.2%
  max_abc faster by 10-20%â”‚   3   â”‚  2.2%
  max_abc faster by 5-10% â”‚   6   â”‚  4.3%
  â‰ˆ Negligible (<5%)      â”‚  87   â”‚ 63.0%  â† MOST CASES!
  max_ab faster by 5-10%  â”‚   8   â”‚  5.8%
  max_ab faster by 10-20% â”‚  15   â”‚ 10.9%
  max_ab faster by >20%   â”‚   9   â”‚  6.5%


RECOMMENDATIONS
--------------------------------------------------------------------------------

ğŸ¯ DEFAULT CHOICE: max_ab
   Reasons:
   â€¢ Slightly better average (0.75% faster)
   â€¢ More predictable (fewer extreme regressions)
   â€¢ Zero errors in test suite
   â€¢ Simpler strategy (ignores output sharding)

ğŸ’¡ USE max_abc WHEN:
   â€¢ Small tensor broadcasts (1Ã—N + MÃ—N)
   â€¢ Interleaved input/output patterns
   â€¢ Output sharding matters for downstream fusion
   â€¢ Memory locality is critical

âš ï¸  AVOID max_abc FOR:
   â€¢ High parallelism scenarios (32 cores)
   â€¢ Height-sharded large tensors
   â€¢ When output sharding is unknown/flexible


KEY INSIGHT
--------------------------------------------------------------------------------
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                         â”‚
â”‚  max_abc does NOT use C's cores for COMPUTATION                        â”‚
â”‚                                                                         â”‚
â”‚  Both strategies compute with max(A, B) cores                          â”‚
â”‚                                                                         â”‚
â”‚  max_abc only tries to match C's SHARDING for OUTPUT                   â”‚
â”‚                                                                         â”‚
â”‚  Performance differences come from OUTPUT LAYOUT, not compute grid     â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


STATISTICAL SUMMARY
--------------------------------------------------------------------------------
Configurations tested:  138
Errors in max_ab:       0
Errors in max_abc:      1 (block sharding validation)

Performance spread:     37.33 Î¼s to 99.45 Î¼s
Max improvement by abc: 40.4% (30.58 Î¼s absolute)
Max improvement by ab:  112.1% (41.83 Î¼s absolute)

63% of cases differ by less than 5% â†’ STRATEGIES ARE VERY SIMILAR


BOTTOM LINE
--------------------------------------------------------------------------------
Use max_ab as the default. It's slightly faster on average, more predictable,
and has no errors. Consider max_abc only for specific small-tensor broadcast
patterns where interleaved output is desired.

The choice matters most in extreme cases (Â±20% difference in 25 configs).
For the majority (87 configs), the strategies perform identically.


================================================================================
Generated: November 13, 2025
Data: 138 matching configurations
Files: example_multiple_ops_max_ab_20251113_013450.csv
       example_multiple_ops_max_abc_20251113_062946.csv
================================================================================
