# --- Meshes ---------------------------------------------------------------

mesh_descriptors {
  name: "Mesh"
  arch: WORMHOLE_B0
  device_topology { dims: [ 2, 4 ] }
  host_topology   { dims: [ 1, 1 ] }
  channels {
    count: 2
    policy: STRICT
  }
}

# --- Graphs ---------------------------------------------------------------

graph_descriptors {
  name: "G0"
  type: "FABRIC"
  # Instances: mesh ids 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15 (all 2x4)
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 0 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 1 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 2 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 3 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 4 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 5 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 6 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 7 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 8 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 9 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 10 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 11 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 12 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 13 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 14 } }
  instances { mesh { mesh_descriptor: "Mesh" mesh_id: 15 } }

  # M0 <-> M1
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 0 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 1 } }
    channels { count: 2 }
  }
  # M0 <-> M2
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 0 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 2 } }
    channels { count: 2 }
  }
  # M0 <-> M3
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 0 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 3 } }
    channels { count: 2 }
  }
  # M0 <-> M8
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 0 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 8 } }
    channels { count: 2 }
  }
  # M1 <-> M2
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 1 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 2 } }
    channels { count: 2 }
  }
  # M1 <-> M3
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 1 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 3 } }
    channels { count: 2 }
  }
  # M2 <-> M3
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 2 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 3 } }
    channels { count: 2 }
  }
  # M2 <-> M5
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 2 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 5 } }
    channels { count: 2 }
  }
  # M3 <-> M12
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 3 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 12 } }
    channels { count: 2 }
  }
  # M4 <-> M5
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 4 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 5 } }
    channels { count: 2 }
  }
  # M4 <-> M6
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 4 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 6 } }
    channels { count: 2 }
  }
  # M4 <-> M7
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 4 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 7 } }
    channels { count: 2 }
  }
  # M4 <-> M11
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 4 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 11 } }
    channels { count: 2 }
  }
  # M5 <-> M6
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 5 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 6 } }
    channels { count: 2 }
  }
  # M5 <-> M7
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 5 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 7 } }
    channels { count: 2 }
  }
  # M6 <-> M7
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 6 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 7 } }
    channels { count: 2 }
  }
  # M7 <-> M15
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 7 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 15 } }
    channels { count: 2 }
  }
  # M8 <-> M9
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 8 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 9 } }
    channels { count: 2 }
  }
  # M8 <-> M10
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 8 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 10 } }
    channels { count: 2 }
  }
  # M8 <-> M11
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 8 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 11 } }
    channels { count: 2 }
  }
  # M9 <-> M10
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 9 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 10 } }
    channels { count: 2 }
  }
  # M9 <-> M11
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 9 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 11 } }
    channels { count: 2 }
  }
  # M10 <-> M11
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 10 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 11 } }
    channels { count: 2 }
  }
  # M10 <-> M13
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 10 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 13 } }
    channels { count: 2 }
  }
  # M12 <-> M13
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 12 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 13 } }
    channels { count: 2 }
  }
  # M12 <-> M14
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 12 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 14 } }
    channels { count: 2 }
  }
  # M12 <-> M15
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 12 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 15 } }
    channels { count: 2 }
  }
  # M13 <-> M14
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 13 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 14 } }
    channels { count: 2 }
  }
  # M13 <-> M15
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 13 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 15 } }
    channels { count: 2 }
  }
  # M14 <-> M15
  connections {
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 14 } }
    nodes { mesh { mesh_descriptor: "Mesh" mesh_id: 15 } }
    channels { count: 2 }
  }
}

# --- Instantiation ----------------------------------------------------------
top_level_instance { graph { graph_descriptor: "G0" graph_id: 0 } }
