allocation_policies:
    receiver:
      max_configs_per_core: 1

Tests:
#
# 1D ring tests are disabled for now due to lack of resources (running them adds ~10s to the quick pipeline)
# For now 1D ring coverage should be taken care of by this legacy test
# ./build/test/tt_metal/tt_fabric/fabric_unit_tests --gtest_filter="EdmFabric.RingDeadlockStabilityTest"
#
# ================================================
# 1D Ring (low latency)
# ================================================
  # - name: "LinearMcastEast"
  #   sync: true

  #   fabric_setup:
  #     topology: Ring

  #   defaults:
  #     ftype: mcast
  #     ntype: unicast_write
  #     size: 512
  #     num_packets: 5000
  #     destination:
  #       hops:
  #         E: 3

  #   patterns:
  #     - type: all_devices_uniform_pattern
  #       iterations: 3

  # - name: "LinearMcastWest"
  #   sync: true

  #   fabric_setup:
  #     topology: Ring

  #   defaults:
  #     ftype: mcast
  #     ntype: unicast_write
  #     size: 512
  #     num_packets: 5000
  #     destination:
  #       hops:
  #         W: 3

  #   patterns:
  #     - type: all_devices_uniform_pattern
  #       iterations: 3

  # - name: "LinearMcastNorth"
  #   sync: true

  #   fabric_setup:
  #     topology: Ring

  #   defaults:
  #     ftype: mcast
  #     ntype: unicast_write
  #     size: 512
  #     num_packets: 5000
  #     destination:
  #       hops:
  #         N: 7

  #   patterns:
  #     - type: all_devices_uniform_pattern
  #       iterations: 3

  # - name: "LinearMcastSouth"
  #   sync: true

  #   fabric_setup:
  #     topology: Ring

  #   defaults:
  #     ftype: mcast
  #     ntype: unicast_write
  #     size: 512
  #     num_packets: 5000
  #     destination:
  #       hops:
  #         S: 7

  #   patterns:
  #     - type: all_devices_uniform_pattern
  #       iterations: 3

# ================================================
# 2D Torus (XY) (low latency)
# ================================================
  - name: "TorusXYLowLatencyMcastEast"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: LowLatency

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          E: 3

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYLowLatencyMcastWest"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: LowLatency

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          W: 3

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYLowLatencyMcastNorth"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: LowLatency

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          N: 7

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYLowLatencyMcastSouth"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: LowLatency

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          S: 7

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYLowLatencyMcastNorthEast"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: LowLatency

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          N: 7
          E: 2

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYLowLatencyMcastNorthWest"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: LowLatency

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          N: 7
          W: 2

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYLowLatencyMcastSouthEast"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: LowLatency

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          S: 7
          E: 2

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYLowLatencyMcastSouthWest"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: LowLatency

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          S: 7
          W: 2

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYLowLatencyMcastAllDirs"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: LowLatency

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          N: 3
          S: 4
          E: 1
          W: 2

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

# ================================================
# 2D Torus (XY) (dynamic routing)
# ================================================
  - name: "TorusXYDynamicMcastEast"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: Dynamic

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          E: 3

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYDynamicMcastWest"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: Dynamic

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          W: 3

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYDynamicMcastNorth"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: Dynamic

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          N: 7

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYDynamicMcastSouth"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: Dynamic

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          S: 7

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYDynamicMcastNorthEast"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: Dynamic

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          N: 7
          E: 2

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYDynamicMcastNorthWest"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: Dynamic

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          N: 7
          W: 2

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYDynamicMcastSouthEast"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: "XY"
      routing_type: Dynamic

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          S: 7
          E: 2

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYDynamicMcastSouthWest"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: Dynamic

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          S: 7
          W: 2

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXYDynamicMcastAllDirs"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: XY
      routing_type: Dynamic

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          N: 3
          S: 4
          E: 1
          W: 2

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

# ================================================
# 2D Torus (X) (low latency)
# ================================================
  - name: "TorusXLowLatencyMcastEast"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: X
      routing_type: LowLatency

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          E: 3

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXLowLatencyMcastWest"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: X
      routing_type: LowLatency

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          W: 3

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

# ================================================
# 2D Torus (Y) (low latency)
# ================================================
  - name: "TorusYLowLatencyMcastNorth"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: Y
      routing_type: LowLatency

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          N: 7

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusYLowLatencyMcastSouth"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: Y
      routing_type: LowLatency

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          S: 7

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

# ================================================
# 2D Torus (X) (dynamic routing)
# ================================================
  - name: "TorusXDynamicMcastEast"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: X
      routing_type: Dynamic

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          E: 3

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusXDynamicMcastWest"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: X
      routing_type: Dynamic

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          W: 3

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

# ================================================
# 2D Torus (Y) (dynamic routing)
# ================================================
  - name: "TorusYDynamicMcastNorth"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: Y
      routing_type: Dynamic

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          N: 7

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3

  - name: "TorusYDynamicMcastSouth"
    sync: true

    fabric_setup:
      topology: Torus
      torus_config: Y
      routing_type: Dynamic

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 512
      num_packets: 5000
      destination:
        hops:
          S: 7

    patterns:
      - type: all_devices_uniform_pattern
        iterations: 3
