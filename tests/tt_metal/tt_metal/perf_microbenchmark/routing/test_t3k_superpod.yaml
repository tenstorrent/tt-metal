# SPDX-FileCopyrightText: Â© 2025 Tenstorrent Inc.
#
# SPDX-License-Identifier: Apache-2.0

allocation_policies:
    receiver:
      max_configs_per_core: 1

physical_mesh:
   mesh_descriptor_path: "tests/tt_metal/tt_fabric/custom_mesh_descriptors/t3k_superpod_mgd.yaml"
   eth_coord_mapping: [
      [
        [0, 0, 0, 0, 0],
        [0, 1, 0, 0, 0],
        [0, 2, 0, 0, 0],
        [0, 3, 0, 0, 0],
        [0, 0, 1, 0, 0],
        [0, 1, 1, 0, 0],
        [0, 2, 1, 0, 0],
        [0, 3, 1, 0, 0],
      ],
      [
        [0, 0, 0, 0, 0],
        [0, 1, 0, 0, 0],
        [0, 2, 0, 0, 0],
        [0, 3, 0, 0, 0],
        [0, 0, 1, 0, 0],
        [0, 1, 1, 0, 0],
        [0, 2, 1, 0, 0],
        [0, 3, 1, 0, 0],
      ],
      [
        [0, 0, 0, 0, 0],
        [0, 1, 0, 0, 0],
        [0, 2, 0, 0, 0],
        [0, 3, 0, 0, 0],
        [0, 0, 1, 0, 0],
        [0, 1, 1, 0, 0],
        [0, 2, 1, 0, 0],
        [0, 3, 1, 0, 0],
      ],
      [
        [0, 0, 0, 0, 0],
        [0, 1, 0, 0, 0],
        [0, 2, 0, 0, 0],
        [0, 3, 0, 0, 0],
        [0, 0, 1, 0, 0],
        [0, 1, 1, 0, 0],
        [0, 2, 1, 0, 0],
        [0, 3, 1, 0, 0],
      ],
      [
        [0, 0, 0, 0, 0],
        [0, 1, 0, 0, 0],
        [0, 2, 0, 0, 0],
        [0, 3, 0, 0, 0],
        [0, 0, 1, 0, 0],
        [0, 1, 1, 0, 0],
        [0, 2, 1, 0, 0],
        [0, 3, 1, 0, 0],
      ],
      [
        [0, 0, 0, 0, 0],
        [0, 1, 0, 0, 0],
        [0, 2, 0, 0, 0],
        [0, 3, 0, 0, 0],
        [0, 0, 1, 0, 0],
        [0, 1, 1, 0, 0],
        [0, 2, 1, 0, 0],
        [0, 3, 1, 0, 0],
      ],
      [
        [0, 0, 0, 0, 0],
        [0, 1, 0, 0, 0],
        [0, 2, 0, 0, 0],
        [0, 3, 0, 0, 0],
        [0, 0, 1, 0, 0],
        [0, 1, 1, 0, 0],
        [0, 2, 1, 0, 0],
        [0, 3, 1, 0, 0],
      ],
      [
        [0, 0, 0, 0, 0],
        [0, 1, 0, 0, 0],
        [0, 2, 0, 0, 0],
        [0, 3, 0, 0, 0],
        [0, 0, 1, 0, 0],
        [0, 1, 1, 0, 0],
        [0, 2, 1, 0, 0],
        [0, 3, 1, 0, 0],
      ],
      [
        [0, 0, 0, 0, 0],
        [0, 1, 0, 0, 0],
        [0, 2, 0, 0, 0],
        [0, 3, 0, 0, 0],
        [0, 0, 1, 0, 0],
        [0, 1, 1, 0, 0],
        [0, 2, 1, 0, 0],
        [0, 3, 1, 0, 0],
      ],
      [
        [0, 0, 0, 0, 0],
        [0, 1, 0, 0, 0],
        [0, 2, 0, 0, 0],
        [0, 3, 0, 0, 0],
        [0, 0, 1, 0, 0],
        [0, 1, 1, 0, 0],
        [0, 2, 1, 0, 0],
        [0, 3, 1, 0, 0],
      ],
      [
        [0, 0, 0, 0, 0],
        [0, 1, 0, 0, 0],
        [0, 2, 0, 0, 0],
        [0, 3, 0, 0, 0],
        [0, 0, 1, 0, 0],
        [0, 1, 1, 0, 0],
        [0, 2, 1, 0, 0],
        [0, 3, 1, 0, 0],
      ],
      [
        [0, 0, 0, 0, 0],
        [0, 1, 0, 0, 0],
        [0, 2, 0, 0, 0],
        [0, 3, 0, 0, 0],
        [0, 0, 1, 0, 0],
        [0, 1, 1, 0, 0],
        [0, 2, 1, 0, 0],
        [0, 3, 1, 0, 0],
      ]
    ]
Tests:
  - name: UnicastWithChipId
    fabric_setup:
      topology: Mesh
      routing_type: Dynamic

    parametrization_params:
      ntype: [unicast_write, atomic_inc, fused_atomic_inc]
      size: [1024, 512, 256, 128, 64, 32]
      num_packets: [1000, 750, 600, 500, 100, 50, 25, 10]

    defaults:
      ftype: unicast
    senders:
      - device: [0, 0]
        patterns:
          - destination:
              device: [1, 0]
          - destination:
              device: [2, 0]
          - destination:
              device: [3, 0]
          - destination:
              device: [4, 0]
          - destination:
              device: [5, 0]
          - destination:
              device: [6, 0]
          - destination:
              device: [7, 0]
          - destination:
              device: [8, 0]
          - destination:
              device: [9, 0]
          - destination:
              device: [10, 0]
          - destination:
              device: [11, 0]
      - device: [0, 1]
        patterns:
          - destination:
              device: [1, 1]
          - destination:
              device: [2, 1]
          - destination:
              device: [3, 1]
          - destination:
              device: [4, 1]
          - destination:
              device: [5, 1]
          - destination:
              device: [6, 1]
          - destination:
              device: [7, 1]
          - destination:
              device: [8, 1]
          - destination:
              device: [9, 1]
          - destination:
              device: [10, 1]
          - destination:
              device: [11, 1]
      - device: [4, 0]
        patterns:
          - destination:
              device: [0, 0]
          - destination:
              device: [1, 0]
          - destination:
              device: [2, 0]
          - destination:
              device: [3, 0]
          - destination:
              device: [5, 0]
          - destination:
              device: [6, 0]
          - destination:
              device: [7, 0]
          - destination:
              device: [8, 0]
          - destination:
              device: [9, 0]
          - destination:
              device: [10, 0]
          - destination:
              device: [11, 0]
      - device: [4, 1]
        patterns:
          - destination:
              device: [0, 1]
          - destination:
              device: [1, 1]
          - destination:
              device: [2, 1]
          - destination:
              device: [3, 1]
          - destination:
              device: [5, 1]
          - destination:
              device: [6, 1]
          - destination:
              device: [7, 1]
          - destination:
              device: [8, 1]
          - destination:
              device: [9, 1]
          - destination:
              device: [10, 1]
          - destination:
              device: [11, 1]
      - device: [7, 0]
        patterns:
          - destination:
              device: [0, 0]
          - destination:
              device: [1, 0]
          - destination:
              device: [2, 0]
          - destination:
              device: [3, 0]
          - destination:
              device: [4, 0]
          - destination:
              device: [5, 0]
          - destination:
              device: [6, 0]
          - destination:
              device: [8, 0]
          - destination:
              device: [9, 0]
          - destination:
              device: [10, 0]
          - destination:
              device: [11, 0]
      - device: [7, 1]
        patterns:
          - destination:
              device: [0, 1]
          - destination:
              device: [1, 1]
          - destination:
              device: [2, 1]
          - destination:
              device: [3, 1]
          - destination:
              device: [4, 1]
          - destination:
              device: [5, 1]
          - destination:
              device: [6, 1]
          - destination:
              device: [8, 1]
          - destination:
              device: [9, 1]
          - destination:
              device: [10, 1]
          - destination:
              device: [11, 1]
      - device: [11, 0]
        patterns:
          - destination:
              device: [0, 0]
          - destination:
              device: [1, 0]
          - destination:
              device: [2, 0]
          - destination:
              device: [3, 0]
          - destination:
              device: [4, 0]
          - destination:
              device: [5, 0]
          - destination:
              device: [6, 0]
          - destination:
              device: [7, 0]
          - destination:
              device: [8, 0]
          - destination:
              device: [9, 0]
          - destination:
              device: [10, 0]
      - device: [11, 1]
        patterns:
          - destination:
              device: [0, 1]
          - destination:
              device: [1, 1]
          - destination:
              device: [2, 1]
          - destination:
              device: [3, 1]
          - destination:
              device: [4, 1]
          - destination:
              device: [5, 1]
          - destination:
              device: [6, 1]
          - destination:
              device: [7, 1]
          - destination:
              device: [8, 1]
          - destination:
              device: [9, 1]
          - destination:
              device: [10, 1]

      - device: [0, 2]
        patterns:
          - destination:
              device: [1, 2]
          - destination:
              device: [2, 2]
          - destination:
              device: [3, 2]
          - destination:
              device: [4, 2]
          - destination:
              device: [5, 2]
          - destination:
              device: [6, 2]
          - destination:
              device: [7, 2]
          - destination:
              device: [8, 2]
          - destination:
              device: [9, 2]
          - destination:
              device: [10, 2]
          - destination:
              device: [11, 2]
      - device: [0, 3]
        patterns:
          - destination:
              device: [1, 3]
          - destination:
              device: [2, 3]
          - destination:
              device: [3, 3]
          - destination:
              device: [4, 3]
          - destination:
              device: [5, 3]
          - destination:
              device: [6, 3]
          - destination:
              device: [7, 3]
          - destination:
              device: [8, 3]
          - destination:
              device: [9, 3]
          - destination:
              device: [10, 3]
          - destination:
              device: [11, 3]
      - device: [4, 2]
        patterns:
          - destination:
              device: [0, 2]
          - destination:
              device: [1, 2]
          - destination:
              device: [2, 2]
          - destination:
              device: [3, 2]
          - destination:
              device: [5, 2]
          - destination:
              device: [6, 2]
          - destination:
              device: [7, 2]
          - destination:
              device: [8, 2]
          - destination:
              device: [9, 2]
          - destination:
              device: [10, 2]
          - destination:
              device: [11, 2]
      - device: [4, 3]
        patterns:
          - destination:
              device: [0, 3]
          - destination:
              device: [1, 3]
          - destination:
              device: [2, 3]
          - destination:
              device: [3, 3]
          - destination:
              device: [5, 3]
          - destination:
              device: [6, 3]
          - destination:
              device: [7, 3]
          - destination:
              device: [8, 3]
          - destination:
              device: [9, 3]
          - destination:
              device: [10, 3]
          - destination:
              device: [11, 3]
      - device: [7, 2]
        patterns:
          - destination:
              device: [0, 2]
          - destination:
              device: [1, 2]
          - destination:
              device: [2, 2]
          - destination:
              device: [3, 2]
          - destination:
              device: [4, 2]
          - destination:
              device: [5, 2]
          - destination:
              device: [6, 2]
          - destination:
              device: [8, 2]
          - destination:
              device: [9, 2]
          - destination:
              device: [10, 2]
          - destination:
              device: [11, 2]
      - device: [7, 3]
        patterns:
          - destination:
              device: [0, 3]
          - destination:
              device: [1, 3]
          - destination:
              device: [2, 3]
          - destination:
              device: [3, 3]
          - destination:
              device: [4, 3]
          - destination:
              device: [5, 3]
          - destination:
              device: [6, 3]
          - destination:
              device: [8, 3]
          - destination:
              device: [9, 3]
          - destination:
              device: [10, 3]
          - destination:
              device: [11, 3]
      - device: [11, 2]
        patterns:
          - destination:
              device: [0, 2]
          - destination:
              device: [1, 2]
          - destination:
              device: [2, 2]
          - destination:
              device: [3, 2]
          - destination:
              device: [4, 2]
          - destination:
              device: [5, 2]
          - destination:
              device: [6, 2]
          - destination:
              device: [7, 2]
          - destination:
              device: [8, 2]
          - destination:
              device: [9, 2]
          - destination:
              device: [10, 2]
      - device: [11, 3]
        patterns:
          - destination:
              device: [0, 3]
          - destination:
              device: [1, 3]
          - destination:
              device: [2, 3]
          - destination:
              device: [3, 3]
          - destination:
              device: [4, 3]
          - destination:
              device: [5, 3]
          - destination:
              device: [6, 3]
          - destination:
              device: [7, 3]
          - destination:
              device: [8, 3]
          - destination:
              device: [9, 3]
          - destination:
              device: [10, 3]
