# Barebones test with multiple iterations.
allocation_policies:
    receiver:
      max_configs_per_core: 4

Tests:
  - name: "MeshMulticast"
    benchmark_mode: true
    sync: true
    fabric_setup:
      topology: Mesh

    parametrization_params:
      num_links: [1, 2, 3, 4]
      ntype: [unicast_write, fused_atomic_inc, unicast_scatter_write]
      size: [2048, 4096]

    defaults:
      ftype: mcast
      num_packets: 200000

    patterns:
      - type: all_to_all
        iterations: 3
  
  - name: "PacketSizesMeshAllToOneUnicast"
    benchmark_mode: true
    sync: true
    fabric_setup:
      topology: Mesh
      routing_type: LowLatency

    parametrization_params:
      size: [1024, 2048, 4096]

    defaults:
      ftype: unicast
      ntype: unicast_write
      num_packets: 50

    patterns:
      - type: all_to_one
  
  # - name: "HelloWorld"
  #   fabric_setup:
  #     topology: Mesh
  #     routing_type: "LowLatency"
  #     fabric_tensix_config: "Default"
  #     num_links: 1

  #   defaults:
  #     ftype: mcast
  #     ntype: unicast_write
  #     size: 2048
  #     num_packets: 200000

  #   # High-level patterns automatically generate the sender configurations.
  #   patterns:
  #     - type: all_to_all

  #   # Other test parameters
  #   top_level_iterations: 1 # Determines how many times the whole YAML file is run.
  #   benchmark_mode: true # If true, the framework will save run results into a csv file.
  #   sync: true # If true, all senders will synchronize before the test begins. Allows us to ensure that all traffic patterns start at roughly the same time. 
  #   seed: 12345 # Used to generate random packet data during testing.
    
