Tests:
  - name: "SimpleUnicastWriteLinear"
    sync: true
    fabric_setup:
      topology: Linear

    senders:
      - device: [0, 0]
        patterns:
          - ftype: unicast
            ntype: unicast_write
            size: 1024
            num_packets: 100
            destination:
              device: [0, 1]

  - name: "TestNocSendTypesLinear"
    sync: true
    fabric_setup:
      topology: Linear

    parametrization_params:
      ntype: [unicast_write, atomic_inc, fused_atomic_inc]

    senders:
      - device: [0, 0]
        patterns:
          - ftype: unicast
            size: 1024
            num_packets: 100
            destination:
              device: [0, 1]

  - name: "TestPacketSizesLinear"
    sync: true
    fabric_setup:
      topology: Linear

    parametrization_params:
      size: [1024, 2048, 4096]

    senders:
      - device: [0, 0]
        patterns:
          - ftype: unicast
            ntype: unicast_write
            num_packets: 100
            destination:
              device: [0, 1]

  - name: "AllToAllUnicastWriteLinear"
    sync: true
    fabric_setup:
      topology: Linear

    defaults:
      ftype: unicast
      ntype: unicast_write
      size: 1024
      num_packets: 100

    patterns:
      - type: all_to_all

  - name: "AllToAllUnicastTestNocSendTypesLinear"
    sync: true
    fabric_setup:
      topology: Linear

    parametrization_params:
      ntype: [unicast_write, atomic_inc, fused_atomic_inc]

    defaults:
      ftype: unicast
      size: 1024
      num_packets: 100

    patterns:
      - type: all_to_all

  - name: "AllToAllMulticastLinear"
    sync: true
    fabric_setup:
      topology: Linear

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 1024
      num_packets: 100

    patterns:
      - type: all_to_all

  - name: "UnidirectionalMulticastLinear"
    sync: true
    fabric_setup:
      topology: Linear

    defaults:
      ftype: mcast
      ntype: unicast_write
      size: 1024
      num_packets: 100

    patterns:
      - type: unidirectional_linear

  - name: "FullDevicePairingLinear"
    sync: true
    fabric_setup:
      topology: Linear

    defaults:
      ftype: unicast
      ntype: unicast_write
      size: 1024
      num_packets: 100

    patterns:
      - type: full_device_random_pairing
        iterations: 5

  - name: AllToAllTestPacketSizesLinear
    sync: true
    fabric_setup:
      topology: Linear

    parametrization_params:
      size: [1024, 2048, 4096]

    defaults:
      ftype: unicast
      ntype: unicast_write
      size: 1024
      num_packets: 100

    patterns:
      - type: all_to_all

  - name: "FlowControlAllToAllLinear"
    sync: true
    enable_flow_control: true
    fabric_setup:
      topology: Linear

    parametrization_params:
      ftype: [unicast, mcast]
      ntype: [unicast_write, atomic_inc, fused_atomic_inc, unicast_scatter_write]
      size: [1024, 2048, 4096]

    defaults:
      num_packets: 10000

    patterns:
      - type: all_to_all

  - name: "SimpleUnicastMesh"
    fabric_setup:
      topology: Mesh

    senders:
      - device: [0, 0]
        patterns:
          - ftype: unicast
            ntype: unicast_write
            size: 1024
            num_packets: 100
            destination:
              device: [0, 1]

  - name: "TestNocSendTypesMesh"
    fabric_setup:
      topology: Mesh

    parametrization_params:
      ntype: [unicast_write, atomic_inc, fused_atomic_inc]

    senders:
      - device: [0, 0]
        patterns:
          - ftype: unicast
            size: 1024
            num_packets: 100
            destination:
              device: [0, 1]

  - name: "AllToAllUnicastMesh"
    fabric_setup:
      topology: Mesh

    defaults:
      ftype: unicast
      ntype: unicast_write
      size: 1024
      num_packets: 100

    patterns:
      - type: all_to_all

  - name: "AllToAllUnicastTestNocSendTypesMesh"
    fabric_setup:
      topology: Mesh

    parametrization_params:
      ntype: [unicast_write, atomic_inc, fused_atomic_inc]

    defaults:
      ftype: unicast
      size: 1024
      num_packets: 100

    patterns:
      - type: all_to_all

  - name: "FullDevicePairingMesh"
    fabric_setup:
      topology: Mesh

    defaults:
      ftype: unicast
      ntype: unicast_write
      size: 1024
      num_packets: 100

    patterns:
      - type: full_device_random_pairing
        iterations: 5

  - name: "FlowControlAllToAllMeshLowLatency"
    sync: true
    enable_flow_control: true
    fabric_setup:
      topology: Mesh

    parametrization_params:
      ftype: [unicast, mcast]
      ntype: [unicast_write, atomic_inc, fused_atomic_inc, unicast_scatter_write]
      size: [1024, 2048, 4096]

    defaults:
      num_packets: 10000

    patterns:
      - type: all_to_all

  - name: "TestNocSendTypesMesh"
    fabric_setup:
      topology: Mesh


    parametrization_params:
      ntype: [unicast_write, atomic_inc, fused_atomic_inc]

    senders:
      - device: [0, 0]
        patterns:
          - ftype: unicast
            size: 1024
            num_packets: 100
            destination:
              device: [0, 1]

  - name: TestPacketSizesMesh
    fabric_setup:
      topology: Mesh

    parametrization_params:
      size: [1024, 2048, 4096]

    senders:
      - device: [0, 0]
        patterns:
          - ftype: unicast
            ntype: unicast_write
            num_packets: 100
            destination:
              device: [0, 1]

  - name: AllToAllUnicastTestPacketSizesMesh
    fabric_setup:
      topology: Mesh

    parametrization_params:
      size: [1024, 2048, 4096]

    defaults:
      ftype: unicast
      ntype: unicast_write
      size: 1024
      num_packets: 100

    patterns:
      - type: all_to_all

  - name: "FlowControlAllToAllMesh"
    sync: true
    enable_flow_control: true
    fabric_setup:
      topology: Mesh

    parametrization_params:
      ftype: [unicast, mcast]
      ntype: [unicast_write, atomic_inc, fused_atomic_inc, unicast_scatter_write]
      size: [1024, 2048, 4096]

    defaults:
      num_packets: 10000

    patterns:
      - type: all_to_all

  - name: AllToOneUnicastMesh
    fabric_setup:
      topology: Mesh

    parametrization_params:
      size: [1024, 2048, 4096]

    defaults:
      ftype: unicast
      ntype: unicast_write
      size: 1024
      num_packets: 100

    patterns:
      - type: all_to_one

  - name: AllToOneRandomUnicastMesh
    fabric_setup:
      topology: Mesh

    parametrization_params:
      size: [1024, 2048, 4096]

    defaults:
      ftype: unicast
      ntype: unicast_write
      size: 1024
      num_packets: 100

    patterns:
      - type: all_to_one_random
        iterations: 10

  - name: "FabricMuxSimpleUnicastWriteLinear"
    skip: [GALAXY, BLACKHOLE_GALAXY]
    fabric_setup:
      topology: Linear
      fabric_tensix_config: Mux

    senders:
      - device: [0, 0]
        patterns:
          - ftype: unicast
            ntype: unicast_write
            size: 1024
            num_packets: 100
            destination:
              device: [0, 1]

  - name: "CustomMaxPacketSizeLinear3K"
    enable_flow_control: true
    fabric_setup:
      topology: Linear
      max_packet_size: 3264

    parametrization_params:
      num_links: [1, 2, 3, 4]
      ntype: [unicast_write, fused_atomic_inc, unicast_scatter_write]
      size: [2048, 3264]

    defaults:
      ftype: mcast
      num_packets: 20000

    patterns:
      - type: all_to_all

  - name: "CustomMaxPacketSizeLinear5K"
    enable_flow_control: true
    fabric_setup:
      topology: Linear
      max_packet_size: 5440

    parametrization_params:
      num_links: [1, 2, 3, 4]
      size: [2048, 4096, 5440]

    defaults:
      ftype: mcast
      ntype: unicast_write
      num_packets: 20000

    patterns:
      - type: all_to_all

  - name: "CustomMaxPacketSizeLinear7K"
    enable_flow_control: true
    fabric_setup:
      topology: Linear
      max_packet_size: 7616

    parametrization_params:
      num_links: [1, 2, 3, 4]
      size: [2048, 4096, 7616]

    defaults:
      ftype: mcast
      ntype: unicast_write
      num_packets: 20000

    patterns:
      - type: all_to_all

  - name: "CustomMaxPacketSizeMesh7K"
    enable_flow_control: true
    fabric_setup:
      topology: Mesh
      max_packet_size: 7616

    parametrization_params:
      num_links: [1, 2, 3, 4]
      size: [2048, 4096, 7616]

    defaults:
      ftype: mcast
      ntype: unicast_write
      num_packets: 20000

    patterns:
      - type: all_to_all

  - name: "CustomMaxPacketSizeLinear8K"
    skip: [wormhole_b0]
    enable_flow_control: true
    fabric_setup:
      topology: Linear
      max_packet_size: 8704

    parametrization_params:
      num_links: [1, 2, 3, 4]
      size: [7616, 8704]

    defaults:
      ftype: mcast
      ntype: unicast_write
      num_packets: 20000

    patterns:
      - type: all_to_all

  - name: "CustomMaxPacketSizeMesh8K"
    skip: [wormhole_b0]
    enable_flow_control: true
    fabric_setup:
      topology: Mesh
      max_packet_size: 8704

    parametrization_params:
      num_links: [1, 2, 3, 4]
      size: [7616, 8704]

    defaults:
      ftype: mcast
      ntype: unicast_write
      num_packets: 20000

    patterns:
      - type: all_to_all

  - name: "CustomMaxPacketSizeLinear15K"
    skip: [wormhole_b0]
    enable_flow_control: true
    fabric_setup:
      topology: Linear
      max_packet_size: 15232

    parametrization_params:
      num_links: [1, 2, 3, 4]
      size: [7616, 8704, 15232]

    defaults:
      ftype: mcast
      ntype: unicast_write
      num_packets: 20000

  - name: "CustomMaxPacketSizeMesh15K"
    skip: [wormhole_b0]
    enable_flow_control: true
    fabric_setup:
      topology: Mesh
      max_packet_size: 15232

    parametrization_params:
      num_links: [1, 2, 3, 4]
      size: [7616, 8704, 15232]

    defaults:
      ftype: mcast
      ntype: unicast_write
      num_packets: 20000

    patterns:
      - type: all_to_all

  - name: "BenchmarkKernelsAllToAllLinear"
    sync: true
    skip_packet_validation: true
    fabric_setup:
      topology: Linear

    parametrization_params:
      ftype: [unicast, mcast]
      ntype: [unicast_write, atomic_inc, fused_atomic_inc, unicast_scatter_write]
      size: [1024, 2048, 4096]

    defaults:
      num_packets: 10000

    patterns:
      - type: all_to_all

  - name: "BenchmarkKernelsAllToAllMesh"
    sync: true
    skip_packet_validation: true
    fabric_setup:
      topology: Mesh

    parametrization_params:
      ftype: [unicast, mcast]
      ntype: [unicast_write, atomic_inc, fused_atomic_inc, unicast_scatter_write]
      size: [1024, 2048, 4096]

    defaults:
      num_packets: 10000

    patterns:
      - type: all_to_all
