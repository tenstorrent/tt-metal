<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tracy Profiler &mdash; TT-Metalium  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tt_theme.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="canonical" href="/tt-metal/latest/tt-metalium/tools/tracy_profiler.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=b3ba4146"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="../_static/posthog.js?v=aa5946f9"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Device Program Profiler" href="device_program_profiler.html" />
    <link rel="prev" title="Watcher" href="watcher.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



<a href="https://docs.tenstorrent.com/">
    <img src="../_static/tt_logo.svg" class="logo" alt="Logo"/>
</a>

<a href="../index.html">
    TT-Metalium
</a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get_started/get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Install</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TT-Metalium</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tt_metal/programming_model/index.html">Programming Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tt_metal/examples/index.html">Programming Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tt_metal/advanced_topics/index.html">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tt_metal/apis/index.html">APIs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="kernel_print.html">Kernel Debug Print</a></li>
<li class="toctree-l2"><a class="reference internal" href="watcher.html">Watcher</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tracy Profiler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enabling-tracy">Enabling Tracy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gui">GUI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installing-for-mac-users">Installing for Mac users</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-for-linux-users">Building for Linux users</a></li>
<li class="toctree-l4"><a class="reference internal" href="#starting-the-gui">Starting the GUI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#capturing-profiling-data">Capturing Profiling Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#capturing-via-command-line">Capturing via Command Line</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#profiling-host-code">Profiling Host Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#c">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python">Python</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#profiling-device-code">Profiling Device Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="device_program_profiler.html">Device Program Profiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="inspector.html">Inspector</a></li>
<li class="toctree-l2"><a class="reference internal" href="triage.html">tt-triage</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../resources/support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/contributing.html">Contributing as a developer</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TT-Metalium</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Tools</a></li>
      <li class="breadcrumb-item active">Tracy Profiler</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tools/tracy_profiler.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tracy-profiler">
<span id="id1"></span><h1>Tracy Profiler<a class="headerlink" href="#tracy-profiler" title="Permalink to this heading"></a>
</h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Tools are only fully supported on source builds.</p>
</div>
<p>Profiling is an essential part of software development that helps developers gain insight into how their code executes, where time is spent, and which parts of the system may be causing performance bottlenecks. By collecting and analyzing detailed runtime data, profiling tools enable developers to identify inefficient code paths, understand resource usage, and make informed decisions about where to focus optimization efforts. Effective profiling is key to improving performance.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a>
</h2>
<p><a class="reference external" href="https://github.com/wolfpld/tracy">Tracy</a> is an opens-source C++ profiling tool with sampling and code instrumentation profiling capabilities. Metalium uses a fork for Tracy adapted to the the Tensix Processors as it’s primary profiling tool.</p>
<p>Detais documentation about Tracy itself can be found here: <a class="reference external" href="https://github.com/wolfpld/tracy/releases/latest/download/tracy.pdf">https://github.com/wolfpld/tracy/releases/latest/download/tracy.pdf</a>. Reading the <code class="docutils literal notranslate"><span class="pre">Quick-start</span> <span class="pre">guide</span></code> section can help with the rest of this documentation.</p>
<p>All host-side code, including python code in <code class="docutils literal notranslate"><span class="pre">tt_metal</span></code> can be profiled using Tracy.</p>
</section>
<section id="enabling-tracy">
<h2>Enabling Tracy<a class="headerlink" href="#enabling-tracy" title="Permalink to this heading"></a>
</h2>
<p>To use Tracy for profiling, you need to build Metalium with profiler support enabled. This is done by setting the <code class="docutils literal notranslate"><span class="pre">ENABLE_TRACY=ON</span></code> option when configuring CMake. Or with the <code class="docutils literal notranslate"><span class="pre">--enable-profiler</span></code> flag in the build script. Profiling features are only available in builds where this option is set.</p>
<p>You can enable the profiler by running:</p>
<div class="highlight-bash notranslate">
<div class="highlight"><pre><span></span><span class="c1"># Via build script</span>
./build_metal.sh<span class="w"> </span>--enable-profiler

<span class="c1"># Via CMake flags</span>
cmake<span class="w"> </span>.<span class="w"> </span>-DENABLE_TRACY<span class="o">=</span>ON
ninja
ninja<span class="w"> </span>install
</pre></div>
</div>
<p>Note that Tracy support is not included in prebuilt binaries or release builds by default. You must build from source with the profiler enabled to use these features.</p>
</section>
<section id="gui">
<h2>GUI<a class="headerlink" href="#gui" title="Permalink to this heading"></a>
</h2>
<p>Tracy provides a GUI application for viewing profiling results. You can open saved profiling sessions or connect to a remote machine to view real-time profiling data, as long as network access to the remote system is available.</p>
<section id="installing-for-mac-users">
<h3>Installing for Mac users<a class="headerlink" href="#installing-for-mac-users" title="Permalink to this heading"></a>
</h3>
<p>Mac users can install Tracy using Homebrew. Open a terminal and run:</p>
<div class="highlight-bash notranslate">
<div class="highlight"><pre><span></span>brew<span class="w"> </span>uninstall<span class="w"> </span>tracy<span class="w"> </span><span class="c1"># Remove any old version of Tracy</span>
wget<span class="w"> </span>-P<span class="w"> </span>~/<span class="w"> </span>--no-check-certificate<span class="w"> </span>--no-cache<span class="w"> </span>--no-cookies<span class="w"> </span>https://raw.githubusercontent.com/tenstorrent-metal/tracy/master/tracy.rb
brew<span class="w"> </span>install<span class="w"> </span>~/tracy.rb
rm<span class="w"> </span>~/tracy.rb
</pre></div>
</div>
<p>After installation, start the Tracy GUI with:</p>
<div class="highlight-bash notranslate">
<div class="highlight"><pre><span></span>tracy
</pre></div>
</div>
</section>
<section id="building-for-linux-users">
<h3>Building for Linux users<a class="headerlink" href="#building-for-linux-users" title="Permalink to this heading"></a>
</h3>
<p>For Linux users, you need to build the Tracy GUI from source. First, clone the Tracy repository.</p>
<div class="highlight-bash notranslate">
<div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/tenstorrent/tracy.git
<span class="nb">cd</span><span class="w"> </span>tracy/profiler/build/unix
make<span class="w"> </span>-j8
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">Tracy-release</span></code> binary will be generated in the current directory after the build completes. You can run it directly from there or copy it to a directory in your PATH for easier access</p>
<div class="highlight-bash notranslate">
<div class="highlight"><pre><span></span>./Tracy-release
</pre></div>
</div>
</section>
<section id="starting-the-gui">
<h3>Starting the GUI<a class="headerlink" href="#starting-the-gui" title="Permalink to this heading"></a>
</h3>
<p>The application will start showing a window similar to the image below.</p>
<a class="reference internal image-reference" href="../_images/tracy-get-started.png"><img alt="Tracy get started" src="../_images/tracy-get-started.png" style="width: 77%;"></a>
</section>
</section>
<section id="capturing-profiling-data">
<h2>Capturing Profiling Data<a class="headerlink" href="#capturing-profiling-data" title="Permalink to this heading"></a>
</h2>
<p>Set the client address to the IP address of the remote machine and port 8086 (e.g. 172.27.28.132:8086), then click connect.</p>
<p>A “Waiting for connection …” dialog will appear after clicking connect.</p>
<img alt="Tracy waiting for connection" src="../_images/tracy-waiting-connection-dialog.webp">
<p>When the host machine starts running a tracy-enabled application, the GUI will automatically collect profiling data and display it in real time.</p>
<p>Counterintuitively, the Tracy GUI connects as a TCP server, while the profiled application runs as a TCP client, usually connecting to port 8086. If your application host is on a different network than the Tracy GUI, you may need to set up port forwarding or a VPN connection. SSH port forwarding is a common solution:</p>
<div class="highlight-bash notranslate">
<div class="highlight"><pre><span></span>ssh<span class="w"> </span>-NL<span class="w"> </span><span class="m">8086</span>:127.0.0.1:8086<span class="w"> </span>user@remote-machine
</pre></div>
</div>
<section id="capturing-via-command-line">
<h3>Capturing via Command Line<a class="headerlink" href="#capturing-via-command-line" title="Permalink to this heading"></a>
</h3>
<p>Alternatively, use the <code class="docutils literal notranslate"><span class="pre">capture-release</span></code> CLI tool built under <strong>tt-metal</strong> when Tracy is enabled, under <code class="docutils literal notranslate"><span class="pre">tt-metal/build/tools/profiler/bin</span></code> when Tracy is enabled. This tool acts as a client that saves the profile to disk, which can then be copied and loaded into the GUI later. To use it, run the following command before starting the application:</p>
<div class="highlight-bash notranslate">
<div class="highlight"><pre><span></span>./capture-release<span class="w"> </span>-o<span class="w"> </span>output_file_name.tracy
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The output of <code class="docutils literal notranslate"><span class="pre">capture-release</span></code> is quite compressible. For large profile files, it is recommended to compress them before transferring over the network. You can use the <code class="docutils literal notranslate"><span class="pre">-z</span></code> option with rsync, <code class="docutils literal notranslate"><span class="pre">-C</span></code> with scp, or standalone tools like gzip or zstd.</p>
</div>
</section>
</section>
<section id="profiling-host-code">
<h2>Profiling Host Code<a class="headerlink" href="#profiling-host-code" title="Permalink to this heading"></a>
</h2>
<section id="c">
<h3>C++<a class="headerlink" href="#c" title="Permalink to this heading"></a>
</h3>
<p>With Tracy enabled in the Metalium build, all C++ marked zones will be profiled. Zones in Tracy are marked sections of code that users are interested in profiling. Tracy provides macros such as  <code class="docutils literal notranslate"><span class="pre">ZoneScoped;</span></code> to accomplish this.</p>
<p>Please refer to section 3 of Tracy’s documentation for further information on zones and available macros.</p>
<p>The following image is a snapshot of Tracy C++ profiling:</p>
<img alt="Tracy C++ run" src="../_images/tracy-c%2B%2B-run.png">
<p>For example, the <code class="docutils literal notranslate"><span class="pre">Device</span></code> constructor shown above is instrumented as follows:</p>
<div class="highlight-C++ notranslate">
<div class="highlight"><pre><span></span><span class="n">Device</span><span class="o">::</span><span class="n">Device</span><span class="p">(</span><span class="n">chip_id_t</span><span class="w"> </span><span class="n">device_id</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint32_t</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">l1_bank_remap</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">id_</span><span class="p">(</span><span class="n">device_id</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">ZoneScoped</span><span class="p">;</span>
<span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">initialize</span><span class="p">(</span><span class="n">l1_bank_remap</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="python">
<h3>Python<a class="headerlink" href="#python" title="Permalink to this heading"></a>
</h3>
<p>Python provides the standard <code class="docutils literal notranslate"><span class="pre">sys.setprofile</span></code> and <code class="docutils literal notranslate"><span class="pre">sys.settrace</span></code> functions for tracing and profiling Python code. These are used to integrate Python profiling with Tracy.</p>
<p>There are several ways to profile Python code with Tracy in Metalium projects.</p>
<section id="python-scripts">
<h4>Python Scripts<a class="headerlink" href="#python-scripts" title="Permalink to this heading"></a>
</h4>
<p>To profile an entire Python script, run your program using the <code class="docutils literal notranslate"><span class="pre">tracy</span></code> module as follows:</p>
<div class="highlight-sh notranslate">
<div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>tracy<span class="w"> </span><span class="o">{</span>test_script<span class="o">}</span>.py
</pre></div>
</div>
</section>
<section id="pytest-sessions">
<h4>Pytest Sessions<a class="headerlink" href="#pytest-sessions" title="Permalink to this heading"></a>
</h4>
<p>For pytest-based tests, import pytest as a module and pass its arguments as needed. For example, to profile a BERT unit test, run:</p>
<div class="highlight-sh notranslate">
<div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>tracy<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>models/experimental/bert_large_performant/unit_tests/test_bert_large_split_and_transform_qkv_heads.py::test_split_query_key_value_and_split_heads_with_program_cache
</pre></div>
</div>
<img alt="Tracy Python run" src="../_images/tracy-python-run.png">
</section>
<section id="instrumenting-python-code">
<h4>Instrumenting Python Code<a class="headerlink" href="#instrumenting-python-code" title="Permalink to this heading"></a>
</h4>
<p>Instrumentation can also be done without using the pytest fixture.</p>
<p>The following shows how to profile a function called <code class="docutils literal notranslate"><span class="pre">function_under_test</span></code> and all of its child python function calls by manually enabling tracy profiler.</p>
<div class="highlight-python notranslate">
<div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">function_under_test</span><span class="p">():</span>
    <span class="n">child_function_1</span><span class="p">()</span>
    <span class="n">child_function_2</span><span class="p">()</span>


<span class="kn">from</span><span class="w"> </span><span class="nn">tracy</span><span class="w"> </span><span class="kn">import</span> <span class="n">Profiler</span>
<span class="n">profiler</span> <span class="o">=</span> <span class="n">Profiler</span><span class="p">()</span>

<span class="n">profiler</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>
<span class="n">function_under_test</span><span class="p">()</span>
<span class="n">profiler</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
</pre></div>
</div>
<p>Similar to the pytest setup, calling the parent script with <code class="docutils literal notranslate"><span class="pre">-p</span></code> option will profile the region where profiler is enabled.</p>
<p><strong>Note</strong>, it is recommended to sandwich the function call between the enable and disable calls rather than having them as first and last calls in the function being profiled. As <code class="docutils literal notranslate"><span class="pre">settrace</span></code> and <code class="docutils literal notranslate"><span class="pre">setprofile</span></code> trigger on more relevant events when the setup is done previous to the function call.</p>
</section>
<section id="signposts-in-python-code">
<h4>Signposts in Python Code<a class="headerlink" href="#signposts-in-python-code" title="Permalink to this heading"></a>
</h4>
<p><code class="docutils literal notranslate"><span class="pre">signpost(header,</span> <span class="pre">message)</span></code> from the <code class="docutils literal notranslate"><span class="pre">tracy</span></code> module can be placed anywhere in the code path for your test. This call will produce a row in the op report CSV and a message in the tracy run.</p>
<div class="highlight-python notranslate">
<div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tracy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signpost</span>

<span class="n">signpost</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="s2">"Run number 5"</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">"This is the run after 5 warmup runs"</span><span class="p">)</span>

<span class="n">run_inference</span><span class="p">()</span>

<span class="n">signpost</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="s2">"Run result post proc"</span><span class="p">)</span>

<span class="n">post_proc</span><span class="p">()</span>
</pre></div>
</div>
<p>The above example will show up as follows.</p>
<p>Op report CSV</p>
<img alt="" src="../_images/tracy-signpost-opreprot.png">
<p>Tracy run</p>
<img alt="Tracy get started" src="../_images/tracy-signpost-run.png">
</section>
<section id="line-level-profiling">
<h4>Line-level Profiling<a class="headerlink" href="#line-level-profiling" title="Permalink to this heading"></a>
</h4>
<p>In some cases, significant duration of a function, does not get broken down to smaller child calls with explainable durations. This is usually either due to inline work that is
not wrapped inside a function or a call to a function that is defined as part of a shared object. For example, <code class="docutils literal notranslate"><span class="pre">pytorch</span></code> function calls do not come in as native python calls and will not generate python call events.</p>
<p>Line-level profiling is only provided with partial profiling because it produces substantially more data.</p>
<p>Add  <code class="docutils literal notranslate"><span class="pre">-l</span></code> option to enable line-level profiling:</p>
<div class="highlight-sh notranslate">
<div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>tracy<span class="w"> </span>-p<span class="w"> </span>-l<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>models/experimental/bert_large_performant/unit_tests/test_bert_large_split_and_transform_qkv_heads.py::test_split_query_key_value_and_split_heads_with_program_cache
</pre></div>
</div>
</section>
</section>
</section>
<section id="profiling-device-code">
<h2>Profiling Device Code<a class="headerlink" href="#profiling-device-code" title="Permalink to this heading"></a>
</h2>
<p>The version of Tracy used in Metalium supports profiling device-side code, including individual Baby RISC-V cores on each Tensix and other tiles on the NoC.</p>
<p>For more details on device-side profiling with Tracy, see <a class="reference internal" href="device_program_profiler.html#device-program-profiler"><span class="std std-ref">Device Program Profiler</span></a>.</p>
</section>
</section>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="watcher.html" class="btn btn-neutral float-left" title="Watcher" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="device_program_profiler.html" class="btn btn-neutral float-right" title="Device Program Profiler" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Tenstorrent.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        Version: <span id="current-version">latest</span>
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl id="version-list">
            <dt>Versions</dt>
        </dl>
        <br>
        </dl>
    </div>
</div>

<script>
const VERSIONS_URL = 'https://raw.githubusercontent.com/tenstorrent/tt-metal/refs/heads/main/docs/published_versions.json';

async function loadVersions() {
    try {
        const response = await fetch(VERSIONS_URL);
        const data = await response.json();
        const versionList = document.getElementById('version-list');
        const projectCode = location.pathname.split('/')[3];

        data.versions.forEach(version => {
            const dd = document.createElement('dd');
            const link = document.createElement('a');
            link.href = `https://docs.tenstorrent.com/tt-metal/${version}/${projectCode}/index.html`;
            link.textContent = version;
            dd.appendChild(link);
            versionList.appendChild(dd);
        });
    } catch (error) {
        console.error('Error loading versions:', error);
    }
}

loadVersions();

function getCurrentVersion() {
    return window.location.pathname.split('/')[2];
}
document.getElementById('current-version').textContent = getCurrentVersion();

const versionEl = document.createElement("span");
versionEl.innerText = getCurrentVersion();
versionEl.className = "project-versions";
const wySideSearchEl = document.getElementsByClassName("wy-side-nav-search").item(0);
if (wySideSearchEl) {
    const projectNameEl = wySideSearchEl.children.item(1);
    if (projectNameEl) projectNameEl.appendChild(versionEl);
}

</script><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>