{
  "moe_block": {
    "weight_path": "/data/MLPerf/huggingface/hub/models--deepseek-ai--DeepSeek-R1-0528/snapshots/4236a6af538feda4548eca9ab308586007567f52",
    "layer_index": 3,
    "module_prefix": "model.layers.3",

    "tensor_parallel": {
      "enabled": true,
      "cluster_axis": 1
    },

    "router": {
      "type": "moe_gate",
      "config": {
        "num_experts": 256,
        "num_experts_per_tok": 6,
        "n_routed_experts": 256,
        "n_group": 8,
        "topk_group": 3,
        "score_correction_bias": true,
        "routed_scaling_factor": 1.0,
        "memory_config": "L1_MEMORY_CONFIG",
        "compute_kernel_config": "HIFI2"
      }
    },

    "experts": {
      "distributed": {
        "enabled": true,
        "dispatch_cluster_axis": 0,
        "memory_config": "L1_MEMORY_CONFIG",
        "output_memory_config": "L1_MEMORY_CONFIG",
        "intermediate_size": 2048,
        "hidden_size": 7168,
        "n_routed_experts": 256,
        "num_experts_per_device": 8,
        "activation": "swiglu",
        "use_quantized_weights": true,
        "weight_block_size": [128, 128]
      },
      "shared": {
        "enabled": true,
        "intermediate_size": 1408,
        "hidden_size": 7168,
        "parallel_with_moe": true,
        "memory_config": "L1_MEMORY_CONFIG",
        "use_quantized_weights": true,
        "weight_block_size": [128, 128]
      }
    },

    "activations_repeat": {
      "repeat_dims": [1, 8, 1, 1]
    },

    "topk_weights_repeat": {
      "repeat_dims": [7168, 1, 1, 1]
    },

    "moe_chunking": {
      "chunk_size": 4096
    },

    "prefill_chunking": {
      "chunk_size": 16384
    },

    "memory_configs": {
      "decode": {
        "dispatch": "L1_MEMORY_CONFIG",
        "combine": "L1_MEMORY_CONFIG",
        "all_gather": "L1_MEMORY_CONFIG",
        "reduce_scatter": "L1_MEMORY_CONFIG"
      },
      "prefill": {
        "dispatch": "DRAM_MEMORY_CONFIG",
        "combine": "DRAM_MEMORY_CONFIG",
        "all_gather": "DRAM_MEMORY_CONFIG",
        "reduce_scatter": "DRAM_MEMORY_CONFIG"
      }
    }
  }
}
