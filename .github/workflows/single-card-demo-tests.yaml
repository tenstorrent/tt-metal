name: "(Single-card) Demo tests"

on:
  workflow_dispatch:
    inputs:
      requested-models:
        description: "List of requested models as JSON array. Default is 'all'"
        default: "all"
        type: string
      run-perf-tests:
        description: "Run perf variants"
        type: boolean
        default: true
  schedule:
    - cron: "0 */6 * * 1,2,3,4,5"
    - cron: "0 */4 * * 0,6"

jobs:
  single-card-demo-tests:
    secrets: inherit
    uses: ./.github/workflows/single-card-demo-tests-impl.yaml
    with:
      docker-image: "ghcr.io/tenstorrent/tt-metal/tt-metalium/ubuntu-22.04-dev-amd64:3a6f3289447c0320d0d176a087255518186f1fc5"
      build-artifact-name: TTMetal_build_any_22.04_amd64_x86_64-linux-clang-17-libstdcpp
      wheel-artifact-name: eager-dist-cp310-ubuntu-22.04-any
      arch: wormhole_b0
      requested-models: ${{ inputs.requested-models || 'all' }}
      # Using || true after is dangerous since that will always be passed in if first value is falsy
      # which it can be if inputs.run-perf-tests isn't clicked. So, scope the default true to only
      # when we're not using workflow_dispatch and can't possibly have an input anyway
      run-perf-tests: ${{ inputs.run-perf-tests || (github.event_name != 'workflow_dispatch' && true) }}
