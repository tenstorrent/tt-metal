---
name: Multi-host Deployment
on:
  push:
    branches:
      - akirby/multi-host-workflow
  workflow_dispatch:

jobs:
  deploy:
    runs-on:
        - multi-host
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Run tt-smi via mpirun command
        run: |
          echo "Running mpirun command on multiple hosts"
          mpirun --rankfile /etc/rankfile -wdir $GITHUB_WORKSPACE --tag-output ./docker-wrapper.sh tt-smi -ls
